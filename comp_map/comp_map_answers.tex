\documentclass[../gatm_answers.tex]{subfiles}

\begin{document}

\section{Composite Mappings of the Plane}

\newcommand{\blanktwomat}{\twomat{\phantom{0}}{\phantom{0}}{}{}}

\begin{outer_problem}[start=1]
\item For Problems~\ref{prob:cm_fill_in_blank_start} through~\ref{prob:cm_fill_in_blank_end}, fill in the blank.
\end{outer_problem}

\begin{inner_problem}[start=1]
\item We start by finding the images of our points under the $-90^\circ$ rotation. \label{prob:cm_fill_in_blank_start}
\end{inner_problem}

\begin{iinner_problem}[start=1]
\item Find the matrix $R$ which results in a $-90^\circ$ rotation.
\end{iinner_problem}

That's just $R=\twomat{\cos -90^\circ}{-\sin -90^\circ}{\sin -90^\circ}{\cos -90^\circ}=\twomat{0}{1}{-1}{0}$.

\begin{iinner_problem}
\item  \label{prob:intermediate_result_matrix} Multiply $R$ by our unit vectors and point $(u,v)$: $$\blanktwomat\left[\begin{array}{ccc} 1 & 0 & u \\ 0 & 1 & v \end{array}\right] = \left[\phantom{\begin{array}{ccc} 1 & 0 & u \\ 0 & 1 & v \end{array}}\right].$$
\end{iinner_problem}

$$\twomat{0}{1}{-1}{0}\begin{bmatrix} 1 & 0 & u \\ 0 & 1 & v \end{bmatrix} = \begin{bmatrix}0 & 1 & v \\ -1 & 0 & -u \\ \end{bmatrix}.$$

\begin{inner_problem}
\item Next, we reflect those intermediate image points over the line $y=0$.
\end{inner_problem}

\begin{iinner_problem}[start=1]
\item Find the matrix $S$ which does this.
\end{iinner_problem}

We want to flip the $y$ coordinate, so $S=\begin{bmatrix} 1 & 0 \\ 0 & -1 \end{bmatrix}$.

\begin{iinner_problem}
\item Multiply $S$ by the result of Problem~\ref{prob:intermediate_result_matrix}.
\end{iinner_problem}

$$\begin{bmatrix} 1 & 0 \\ 0 & -1 \end{bmatrix} \begin{bmatrix}0 & 1 & v \\ -1 & 0 & -u \\ \end{bmatrix}=\begin{bmatrix} 0 & 1 & v \\ 1 & 0 & v \end{bmatrix}.$$

\begin{inner_problem}
\item You should notice that the net result of the two transformations taken together is a reflection over the line $y=x$. Which matrix represents this transformation?
\end{inner_problem}

The matrix that represents a reflection over $y=x$ is $M=\begin{bmatrix} 0 & 1 \\ 1 & 0 \\ \end{bmatrix}$.

\begin{inner_problem}
\item Notice that what we did to achieve this mapping was $$\twomat{1}{0}{0}{-1}\twomat{0}{1}{-1}{0}\left[\begin{array}{ccc} 1 & 0 & u \\ 0 & 1 & v \end{array}\right]=\left[\phantom{\begin{array}{ccc} 1 & 0 & u \\ 0 & 1 & v \end{array}}\right],$$
where we multiplied the two rightmost matrices first but didn't use the associative property to multiply the two leftmost matrices first. See what happens when you multiply the two left hand matrices together: $$\twomat{1}{0}{0}{-1}\twomat{0}{1}{-1}{0}=\blanktwomat.$$ Look familiar?
\end{inner_problem}

$$\twomat{1}{0}{0}{-1}\twomat{0}{1}{-1}{0} = \begin{bmatrix} 0 & 1 \\ 1 & 0 \\ \end{bmatrix}.$$

This is our matrix $M$ from part (c)!

\begin{inner_problem}
\item See what happens when you reverse the order of multiplication: \label{prob:cm_fill_in_blank_end}
$$\twomat{0}{1}{-1}{0}\twomat{1}{0}{0}{-1}=\blanktwomat$$
\end{inner_problem}

$$\twomat{0}{1}{-1}{0}\twomat{1}{0}{0}{-1}=\begin{bmatrix} 0 & -1 \\ -1 & 0 \end{bmatrix}.$$

\begin{inner_problem}
\item
\end{inner_problem}

\begin{iinner_problem}[start=1]
\item What transformation does this new matrix result in?
\end{iinner_problem}

This is a reflection about the line $y=-x$. After all, we have the mappings $(1,0)\to (0,-1)$ and $(0,1)\to (-1,0)$:

\begin{center}
\begin{asy}[width=0.4\textwidth]
import graph;

pair A = (1,0);
pair Ap = (0,-1);
pair B = (0,1);
pair Bp = (-1,0);

path Ac = A--Ap;
path Bc = B--Bp;

dot(A);
dot(Ap);
dot(B);
dot(Bp);

draw(point(Ac,0.1)--point(Ac,0.9),Arrow);
draw(point(Bc,0.1)--point(Bc,0.9),Arrow);

xaxis("$x$");
yaxis("$y$");
draw((-0.85,0.85)--(0.85,-0.85), dashed);

label("$y=-x$", (-0.85,0.85), NE);
\end{asy}
\captionof{figure}{The mapping is a reflection over $y=-x$.}
\end{center}

\begin{iinner_problem}
\item How is a reflection followed by a rotation different from a rotation followed by a reflection? Visualize this by following what happens to a point under both sets of transformations.
\end{iinner_problem}

A reflection followed by a rotation and a rotation followed by a reflection are both (at least in 2D) reflections overall. In our example, the first ordering of the matrices is the rotation followed by the reflection (recall we're working from right to left), and the second ordering is the reflection followed by the rotation.

In a reflection followed by a rotation clockwise (a.k.a. our rotation of $-90^\circ$), the line of reflection is moved clockwise by half the (positive) angle of rotation. In a rotation clockwise followed by a reflection, the line of reflection is moved \textit{counterclockwise} by half the angle of rotation.

\begin{inner_problem}
\item Notice that we apply the transformations from right to left. If you wanted to read from left to right, what would you have to change about the way you wrote the mapping matrices, the vectors representing points, and the order of the matrices?
\end{inner_problem}

We would have to reverse the order of the matrices, write the vectors representing points as row vectors, and transpose the matrices. For example, here is our original notation:

$$\twomat{0}{1}{-1}{0}\twomat{1}{0}{0}{-1}\begin{bmatrix} a \\ b \end{bmatrix} = \begin{bmatrix}-b \\ -a \end{bmatrix},$$

and here is it in a left to right format:

$$\begin{bmatrix} a & b \end{bmatrix} \twomat{1}{0}{0}{-1}\twomat{0}{-1}{1}{0} = \begin{bmatrix} -b & -a \end{bmatrix}.$$

\begin{inner_problem}
\item How does our convention for ordering transformation matrices compare...
\end{inner_problem}

\begin{iinner_problem}[start=1]
\item ... to the convention for writing composite functions, like $f(g(x))$?
\end{iinner_problem}

It is similar in order to composing functions, because these both are evaluated sequentially from the right to the left.

\begin{iinner_problem}
\item ... to the ``followed by'' convention we used for ``From Snaps to Flips?''
\end{iinner_problem}

We evaluated the flip elements from right to left, so it is like our transformation matrices.

\begin{iinner_problem}
\item ... to the ``from \underline{\phantom{0}} to \underline{\phantom{0}}'' convention for transportation matrices?
\end{iinner_problem}

We wrote transportation matrices with the destinations between on top (as columns), and the origins on the left side (as rows). Thus, they are evaluated from left to right, and our unlike our transformation matrices.

\begin{outer_problem}
\item There are two, infinite classes of matrices which comprise all isometries of the plane which keep the origin fixed. These are the rotation matrix and reflection matrix. Let's look first at the rotation matrix and make sure that it really always works the way it should.
\end{outer_problem}

\begin{inner_problem}[start=1]
\item What is the result of a rotation by an angle $\theta$ followed by one of $\phi$?
\end{inner_problem}

It is a rotation by $\theta + \phi$.

\begin{inner_problem}
\item Multiply their rotation matrices: $\twomat{\cos \phi}{-\sin \phi}{\sin\phi}{\cos\phi} \twomat{\cos \theta}{-\sin \theta}{\sin\theta}{\cos\theta}=\blanktwomat.$
\end{inner_problem}

$$\twomat{\cos \phi}{-\sin \phi}{\sin\phi}{\cos\phi} \twomat{\cos \theta}{-\sin \theta}{\sin\theta}{\cos\theta} = \begin{bmatrix} \cos\phi\cos\theta - \sin\phi\sin\theta & -\cos\phi\sin\theta-\sin\phi\cos\theta \\ \sin\phi\cos\theta + \cos\phi\sin\theta & -\sin\phi\sin\theta+\cos\phi\cos\theta \end{bmatrix}.$$

\begin{inner_problem}
\item Use the angle addition formulae to simplify your answer.
\end{inner_problem}

$$\begin{bmatrix} \cos\phi\cos\theta - \sin\phi\sin\theta & -\cos\phi\sin\theta-\sin\phi\cos\theta \\ \sin\phi\cos\theta + \cos\phi\sin\theta & -\sin\phi\sin\theta+\cos\phi\cos\theta \end{bmatrix} = \begin{bmatrix} \cos(\phi+\theta) & -\sin(\phi + \theta) \\ \sin(\phi + \theta) & \cos(\phi + \theta)\end{bmatrix}.$$

\begin{inner_problem}
\item Should the result be the same if you reverse the order of rotation?
\end{inner_problem}

Yes, since rotation is (unlike most other planar transformations) commutative.

\begin{inner_problem}
\item What happens to the points $(1,0)$, $(0,1)$, and $(x,y)$ when you operate on them with the rotation matrix? $$\twomat{\cos \theta}{-\sin \theta}{\sin\theta}{\cos\theta}\left[\begin{array}{ccc} 1 & 0 & x \\ 0 & 1 & y \end{array}\right].$$
\end{inner_problem}

We multiply as directed:

$$\twomat{\cos \theta}{-\sin \theta}{\sin\theta}{\cos\theta}\begin{bmatrix} 1 & 0 & x \\ 0 & 1 & y \end{bmatrix} = \begin{bmatrix}\cos \theta & -\sin\theta & x\cos\theta - y\sin\theta \\ \sin\theta & \cos\theta & x\sin\theta + y\cos\theta \end{bmatrix}.$$

\begin{outer_problem}
\item Now let's check for the generalized reflection matrix.
\end{outer_problem}

\begin{inner_problem}[start=1]
\item Take the matrix which results in a reflection over the line $y=x\tan \frac{\theta}{2}$ and reflect over that line twice: $$\twomat{\cos\theta}{\sin\theta}{\sin\theta}{-\cos\theta}\twomat{\cos\theta}{\sin\theta}{\sin\theta}{-\cos\theta}.$$
\end{inner_problem}

$$\twomat{\cos\theta}{\sin\theta}{\sin\theta}{-\cos\theta}\twomat{\cos\theta}{\sin\theta}{\sin\theta}{-\cos\theta} = \begin{bmatrix} \cos^2\theta + \sin^2\theta & \cos\theta\sin\theta-\cos\theta\sin\theta \\ \sin\theta\cos\theta - \sin\theta\cos\theta & \sin^2\theta + \cos^2\theta\end{bmatrix}.$$

\begin{inner_problem}
\item Simplify your answer and explain the result.
\end{inner_problem}

$$\begin{bmatrix} \cos^2\theta + \sin^2\theta & \cos\theta\sin\theta-\cos\theta\sin\theta \\ \sin\theta\cos\theta - \sin\theta\cos\theta & \sin^2\theta + \cos^2\theta\end{bmatrix} = \twomat{1}{0}{0}{1}.$$

This happens because a reflection is its own inverse. How boring!

\begin{inner_problem}
\item Let's do a reflection over the line $y=\tan\frac{\theta}{2}$ followed by a reflection over the line $y=\tan\frac{\phi}{2}$:
$$\twomat{\cos\theta}{\sin\theta}{\sin\theta}{-\cos\theta}\twomat{\cos\phi}{\sin\phi}{\sin\phi}{-\cos\phi}.$$
\end{inner_problem}

$$\twomat{\cos\theta}{\sin\theta}{\sin\theta}{-\cos\theta}\twomat{\cos\phi}{\sin\phi}{\sin\phi}{-\cos\phi} = \begin{bmatrix}
\cos\theta\cos\phi + \sin\theta\sin\phi & \cos\theta\sin\phi-\sin\theta\cos\phi \\ \sin\theta\cos\phi-\cos\theta\sin\phi & \sin\theta\sin\phi + \cos\theta\cos\phi
\end{bmatrix}.$$

\begin{inner_problem}
\item Simplify your answer using the angle addition formulae, and interpret.
\end{inner_problem}

$$\begin{bmatrix}
\cos\theta\cos\phi + \sin\theta\sin\phi & \cos\theta\sin\phi-\sin\theta\cos\phi \\ \sin\theta\cos\phi-\cos\theta\sin\phi & \sin\theta\sin\phi + \cos\theta\cos\phi
\end{bmatrix}=\begin{bmatrix}\cos(\theta-\phi) & \sin(\phi-\theta) \\ \sin(\theta-\phi) & \cos(\theta-\phi)\end{bmatrix}=\begin{bmatrix}\cos(\theta-\phi) & -\sin(\theta-\phi) \\ \sin(\theta-\phi) & \cos(\theta-\phi)\end{bmatrix}.
$$

This is rotation by $\theta-\phi$ counterclockwise.

\begin{inner_problem}
\item Does it make a difference which reflection comes first? Do the matrix multiplication to confirm your answer.
\end{inner_problem}

In general, reflections aren't commutative, so it probably will make a difference.

$$\twomat{\cos\phi}{\sin\phi}{\sin\phi}{-\cos\phi}\twomat{\cos\theta}{\sin\theta}{\sin\theta}{-\cos\theta}=\begin{bmatrix} \cos\phi\cos\theta + \sin\phi\sin\theta & \cos\phi\sin\theta - \sin\phi\cos\theta \\ \sin\phi\cos\theta - \cos\phi\sin\theta & \sin\phi\sin\theta + \cos\phi\cos\theta \\ \end{bmatrix} = \begin{bmatrix}\cos(\phi-\theta) & -\sin(\phi-\theta) \\ \sin(\phi-\theta) & \cos(\phi-\theta)\end{bmatrix}.$$

This is different from the original. In fact, it is the opposite rotation (and thus the matrix's inverse).

We didn't really have to do the matrix multiplication. We could have substituted the rather confusing $\theta = \phi'$ and $\phi = \theta'$ into the original expression and gotten the same result. Oh well.

\begin{outer_problem}
\item We've found specific matrices which map the plane in the following ways:
\begin{itemize}
\item identity;
\item rotation about the origin by $\theta$;
\item reflection over a line $y=x \tan\frac{\theta}{2}$;
\item size change by some factor centered at the origin;
\item stretching along a specific line through the origin by some factor;
\item shearing perpendicular to a specific line through the origin by some factor.
\end{itemize}
We want to generalize those ideas. What does each of the following matrices do? Be quantitative by specifying angle, equation of line, and/or factor:\label{prob:list_transformations}
\end{outer_problem}

\begin{inner_problem}[start=1]
\item $\twomat{1}{0}{0}{1}$ \label{prob:list_transformations_part_start}
\end{inner_problem}

This is the identity matrix; it does nothing.

\begin{inner_problem}
\item $\twomat{a}{0}{0}{a}$
\end{inner_problem}

This matrix scales (or dilates) through the origin by a factor of $a$.

\begin{inner_problem}
\item $\twomat{\cos\theta}{-\sin\theta}{\sin\theta}{\cos\theta}$
\end{inner_problem}

This matrix rotates counterclockwise by $\theta$.

\begin{inner_problem}
\item $\twomat{\cos\theta}{\sin\theta}{-\sin\theta}{\cos\theta}$
\end{inner_problem}

This is initially rather mysterious, but if we recall that $\cos\theta = \cos-\theta$ and $\sin-\theta = -\sin\theta$, we realize that this matrix can be rewritten:

$$\twomat{\cos\theta}{\sin\theta}{-\sin\theta}{\cos\theta}= \twomat{\cos-\theta}{-\sin-\theta}{\sin-\theta}{\cos-\theta}.$$

This makes it clear that it is a rotation clockwise by $\theta$.

\begin{inner_problem}
\item $\twomat{a}{0}{0}{1}$
\end{inner_problem}

This is a stretch (or squish) along the $x$-axis by a factor of $a$.

\begin{inner_problem}
\item $\twomat{1}{0}{0}{a}$
\end{inner_problem}

This is a stretch (or squish) along the $y$-axis by a factor of $a$.

\begin{inner_problem}
\item $\twomat{1}{a}{0}{1}$
\end{inner_problem}

This is a shear along the $x$-axis by a factor of $a$.

\begin{inner_problem}
\item $\twomat{1}{0}{a}{1}$
\end{inner_problem}

This is a shear along the $y$-axis by a factor of $a$.

\begin{inner_problem}
\item $\twomat{a}{b}{ca}{cb}$
\end{inner_problem}

Again, this seems a bit foreign. Multiplying it by a point $(u,v)$, though, we see its true meaning:

$$\twomat{a}{b}{ca}{cb}\begin{bmatrix} u \\ v \end{bmatrix} = \begin{bmatrix} au+bv \\ c(au+bv) \end{bmatrix}.$$

Letting $t=au+bv$, we see that this parametrizes the line $t\begin{bmatrix}1 \\ c \end{bmatrix}$. In standard form, this is $cx-y=0$; in sane person's form, this is $y = cx$.

\begin{inner_problem}
\item $\twomat{-1}{0}{0}{1}$ \label{prob:highlighted_example_list_transformations1}
\end{inner_problem}

This is a negation of the $x$ coordinate, or a reflection about the $y$-axis.

\begin{inner_problem}
\item $\twomat{0}{-1}{-1}{0}$ \label{prob:highlighted_example_list_transformations2}
\end{inner_problem}

As we found earlier, this is a reflection about the line $y=-x$.

\begin{inner_problem}
\item $\twomat{\cos 2\theta}{\sin 2\theta}{\sin 2\theta}{-\cos 2\theta}$ \label{prob:list_transformations_part_end}
\end{inner_problem}

Another rather foreign one. We notice that it is similar to the rotation matrix by $2\theta$, but the right column is negated. As a matrix multiplication, we have

$$\twomat{\cos 2\theta}{\sin 2\theta}{\sin 2\theta}{-\cos 2\theta} = \twomat{\cos 2\theta}{-\sin 2\theta}{\sin 2\theta}{\cos 2\theta}\twomat{1}{0}{0}{-1}.$$

Thus, this matrix is a reflection about the $x$-axis, followed by a rotation of $2\theta$ counterclockwise. We know a reflection followed by a rotation is a reflection, so what axis is this reflection about?

Well, an easy way to find out is to note which points remain \textit{fixed} after the matrix transformation, as these will be precisely the points on the line of reflection. Let the point be $(c,1)$, since then $(tc,t)$ gives every point on the line of reflection. We wish to solve the system of equations

$$\twomat{\cos 2\theta}{\sin 2\theta}{\sin 2\theta}{-\cos 2\theta}\begin{bmatrix} c \\ 1 \end{bmatrix} = \begin{bmatrix} c \\ 1 \end{bmatrix}.$$

Multiplying out the left side, we get

$$\begin{bmatrix} c\cos 2\theta + \sin 2\theta \\ c\sin 2\theta - \cos 2\theta \end{bmatrix} = \begin{bmatrix} c \\ 1 \end{bmatrix}.$$

Equating corresponding parts, we get the system of equations

$$\begin{cases} c\cos 2\theta + \sin 2\theta = c \\ c\sin 2\theta - \cos 2\theta = 1 \end{cases}.$$

The second equation gives us $c = \frac{1+\cos 2\theta}{\sin 2\theta}$. By the double angle formula, this is

$$c= \frac{1+2\cos^2\theta - 1}{2\cos\theta\sin\theta} = \frac{2\cos^2\theta}{2\cos\theta\sin\theta} = \frac{\cos\theta}{\sin\theta} = \cot\theta.$$

Thus, the line can be parameterized as $(t\cot\theta, t)$. In standard form, this is $x-y\cot\theta = 0$; in sane person's form, this is $y=x\tan\theta$. Thus, this matrix is a reflection over the line $y=x\tan\theta$, which is the line $\theta = \theta$ in polar coordinates. That's some unfortunate notation, but I hope you get what I mean.

\begin{outer_problem}
\item What matrix/transformation undoes each of \ref{prob:list_transformations_part_start} through \ref{prob:list_transformations_part_end}? For instance, matrix x is a rotation of $\theta$. It is undone by a rotation of $-\theta$.
\end{outer_problem}

\begin{inner_problem}[start=1]
\item $\twomat{1}{0}{0}{1}$ \label{prob:list_transformations_part_start}
\end{inner_problem}

The inverse of the identity matrix is itself: $\twomat{1}{0}{0}{1}$.

\begin{inner_problem}
\item $\twomat{a}{0}{0}{a}$
\end{inner_problem}

The inverse is a scaling by $\frac{1}{a}$: $\twomat{\frac{1}{a}}{0}{0}{\frac{1}{a}}$.

\begin{inner_problem}
\item $\twomat{\cos\theta}{-\sin\theta}{\sin\theta}{\cos\theta}$
\end{inner_problem}

This matrix rotates counterclockwise by $\theta$. Thus, the inverse is a rotation by $-\theta$---or a rotation clockwise by $\theta$---which is $\twomat{\cos\theta}{\sin\theta}{-\sin\theta}{\cos\theta}$ (the subject of the next problem).

\begin{inner_problem}
\item $\twomat{\cos\theta}{\sin\theta}{-\sin\theta}{\cos\theta}$
\end{inner_problem}

This is a rotation clockwise by $\theta$, so the inverse is a matrix rotating counterclockwise by $\theta$: $\twomat{\cos\theta}{-\sin\theta}{\sin\theta}{\cos\theta}$, the subject of the previous problem.

\begin{inner_problem}
\item $\twomat{a}{0}{0}{1}$
\end{inner_problem}

This is a stretch (or squish) along the $x$-axis by a factor of $a$. Thus, the inverse is a stretch along the $x$-axis by a factor of $a$: $\twomat{\frac{1}{a}}{0}{0}{1}$.

\begin{inner_problem}
\item $\twomat{1}{0}{0}{a}$
\end{inner_problem}

This is a stretch (or squish) along the $y$-axis by a factor of $a$. Thus, the inverse is a stretch along the $y$-axis by a factor of $a$: $\twomat{1}{0}{0}{\frac{1}{a}}$.

\begin{inner_problem}
\item $\twomat{1}{a}{0}{1}$
\end{inner_problem}

This is a shear along the $x$-axis by a factor of $a$. Thus, the inverse is a shear along the $x$-axis by a factor of $-a$: $\twomat{1}{-a}{0}{1}$.

\begin{inner_problem}
\item $\twomat{1}{0}{a}{1}$
\end{inner_problem}

This is a shear along the $y$-axis by a factor of $a$. Thus, the inverse is a shear along the $y$-axis by a factor of $-a$: $\twomat{1}{0}{-a}{1}$.

\begin{inner_problem}
\item $\twomat{a}{b}{ca}{cb}$
\end{inner_problem}

This matrix doesn't have an inverse, because multiple points can be mapped to the same point. For example, if $a=b=c=1$, then the matrix is $\begin{bmatrix} 1 & 1 \\ 1 & 1 \end{bmatrix}$. Then for example, both $\begin{bmatrix} 0 \\ 0 \end{bmatrix}$ and $\begin{bmatrix} 1 & -1 \end{bmatrix}$ are mapped to $\begin{bmatrix} 0 \\ 0 \end{bmatrix}$.

\begin{inner_problem}
\item $\twomat{-1}{0}{0}{1}$ \label{prob:highlighted_example_list_transformations1}
\end{inner_problem}

This is a negation of the $x$ coordinate, or a reflection about the $y$-axis. Since it's a reflection, the inverse is itself: $\twomat{-1}{0}{0}{1}$.

\begin{inner_problem}
\item $\twomat{0}{-1}{-1}{0}$ \label{prob:highlighted_example_list_transformations2}
\end{inner_problem}

As we found earlier, this is a reflection about the line $y=-x$. Since it's a reflection, the inverse is itself: $\twomat{0}{-1}{-1}{0}$.

\begin{inner_problem}
\item $\twomat{\cos 2\theta}{\sin 2\theta}{\sin 2\theta}{-\cos 2\theta}$ \label{prob:list_transformations_part_end}
\end{inner_problem}

We found that this matrix is a reflection over the line $y=x\tan\theta$. Since it's a reflection, it is its own inverse: $\twomat{\cos 2\theta}{\sin 2\theta}{\sin 2\theta}{-\cos 2\theta}$.

\begin{outer_problem}
\item In this problem, you will observe the effects of multiplying two or more matrices. Do the following matrix multiplications, graph the preimage $\left[\begin{smallmatrix}1 & 0 \\ 0 & 1\end{smallmatrix}\right]$ and image, then identify the transformations and their order. Note the effect of order on the outcome!

\begin{minipage}{0.7\textwidth}
But first, an example:
$$\twomat{5}{0}{0}{5}\twomat{.8}{.6}{-.6}{.8}=\twomat{4}{3}{-3}{4}.$$
This is a rotation of $\tan^{-1}\left(-\frac{3}{4}\right)\approx-36.87^\circ$, followed by a size change by a factor of $5$. Remember to read from right to left. The preimage and image are shown in Figure~\ref{fig:preimage_image_mat}.
\end{minipage}\hfill
\begin{minipage}{0.25\textwidth}
\begin{asy}[width=\textwidth]
draw((-2,0)--(9.5,0),Arrow);
draw((0,-5)--(0,6.5),Arrow);

for (int i = -1; i < 9; ++i) {
	for (int j = -4; j < 6; ++j) {
		dot((i, j), filltype=FillDraw(fillpen=white, drawpen=black));
	}
}
filltype fillc =FillDraw(fillpen=black,drawpen=black);
pen size = 1+currentpen;

dot((0,0), size, fillc);
dot((1,0), size, fillc);
dot((0,1), size, fillc);

dot((3,4), size, fillc);
dot((4,-3), size, fillc);

path rot1=(0,1)..(3,4);
path rot2=(1,0)..(4,-3);

draw(subpath(rot1,0.1,0.9),Arrow);
draw(subpath(rot2,0.1,0.9),Arrow);
\end{asy}
\captionof{figure}{The preimage and image.}
\label{fig:preimage_image_mat}
\end{minipage}
\end{outer_problem}

\begin{asydef}
import graph;

void graphMatrix(real a, real b, real c, real d) {
	dot((1,0));
	dot((0,1));

	label("$A$", (1,0), N);
	label("$B$", (0,1), E);

	label("$A'$", (a,c), unit((a-b,c-d)));
	label("$B'$", (b,d), unit((b-a,d-c)));

	dot((a,c));
	dot((b,d));

	xaxis("$x$");
	yaxis("$y$");
}
\end{asydef}

\begin{inner_problem}[start=1]
\item $\twomat{1}{2}{0}{1}\twomat{.6}{-.8}{.8}{.6}$
\end{inner_problem}

$$\twomat{1}{2}{0}{1}\twomat{.6}{-.8}{.8}{.6}=\twomat{2.2}{0.4}{0.8}{0.6}.$$

This is a rotation of $\tan^{-1} \frac{4}{3} \approx 53.13^\circ$, followed by a shear along the $x$-axis by a factor of $2$.

\begin{center}
\begin{asy}[width=0.15\textwidth]
graphMatrix(2.2,0.4,0.8,0.6);
\end{asy}
\end{center}

\begin{inner_problem}
\item $\twomat{.6}{-.8}{.8}{.6}\twomat{1}{2}{0}{1}$
\end{inner_problem}

$$\twomat{.6}{-.8}{.8}{.6}\twomat{1}{2}{0}{1}=\twomat{0.6}{0.4}{0.8}{2.2}.$$

This is a shear along the $x$-axis by a factor of $2$, followed by a rotation of $\tan^{-1} \frac{4}{3} \approx 53.13^\circ$. The order does change the outcome as compared with the previous problem.

\begin{center}
\begin{asy}[width=0.17\textwidth]
graphMatrix(0.6,0.4,0.8,2.2);
\end{asy}
\end{center}

\begin{inner_problem}
\item $\twomat{4}{0}{0}{1}\twomat{\frac{\sqrt{3}}{2}}{\frac{1}{2}}{-\frac{1}{2}}{\frac{\sqrt{3}}{2}}$
\end{inner_problem}

$$\twomat{4}{0}{0}{1}\twomat{\frac{\sqrt{3}}{2}}{\frac{1}{2}}{-\frac{1}{2}}{\frac{\sqrt{3}}{2}}=\twomat{2\sqrt{3}}{2}{-\frac{1}{2}}{\frac{\sqrt{3}}{2}}.$$

This is a rotation of $60^\circ$, followed by a stretch along the $x$-axis by a factor of $4$.

\begin{center}
\begin{asy}[width=0.3\textwidth]
graphMatrix(2 * sqrt(3), 2, -1/2, sqrt(3)/2);
\end{asy}
\end{center}

\begin{inner_problem}
\item $\twomat{\frac{\sqrt{3}}{2}}{\frac{1}{2}}{-\frac{1}{2}}{\frac{\sqrt{3}}{2}}\twomat{4}{0}{0}{1}$
\end{inner_problem}

$$\twomat{\frac{\sqrt{3}}{2}}{\frac{1}{2}}{-\frac{1}{2}}{\frac{\sqrt{3}}{2}}\twomat{4}{0}{0}{1}=\twomat{2\sqrt{3}}{\frac{1}{2}}{-2}{\frac{\sqrt{3}}{2}}.$$

This is a stretch along the $x$-axis by a factor of $4$, followed by a rotation of $60^\circ$.

\begin{center}
\begin{asy}[width=0.3\textwidth]
import graph;

real a = 2 * sqrt(3);
real b = 1/2;
real c = -2;
real d = sqrt(3)/2;

dot((1,0));
dot((0,1));

label("$A$", (1,0), N);
label("$B$", (0,1), E);

label("$A'$", (a,c), unit((a-b,c-d)));
label("$B'$", (b,d), E);

dot((a,c));
dot((b,d));

xaxis("$x$");
yaxis("$y$");
\end{asy}
\end{center}

\begin{inner_problem}
\item $\twomat{.8}{.6}{-.6}{.8}\twomat{5}{0}{0}{5}$
\end{inner_problem}

$$\twomat{.8}{.6}{-.6}{.8}\twomat{5}{0}{0}{5}=\twomat{4}{3}{-3}{4}.$$

This is a dilation by a factor of $5$, followed by a rotation of $\tan^{-1} -\frac{3}{4} \approx -36.87^\circ$.

\begin{center}
\begin{asy}[width=0.2\textwidth]
graphMatrix(4,3,-3,4);
\end{asy}
\end{center}

\begin{inner_problem}
\item $\twomat{5}{0}{0}{5}\twomat{.8}{.6}{-.6}{.8}$
\end{inner_problem}

$$\twomat{5}{0}{0}{5}\twomat{.8}{.6}{-.6}{.8}=\twomat{4}{3}{-3}{4}.$$

This is a rotation of $\tan^{-1} -\frac{3}{4} \approx -36.87^\circ$, followed by a dilation by a factor of $5$. In this case, order doesn't matter.

\begin{center}
\begin{asy}[width=0.2\textwidth]
graphMatrix(4,3,-3,4);
\end{asy}
\end{center}

\begin{inner_problem}
\item $\twomat{.6}{-.8}{.8}{.6}\twomat{.8}{-.6}{.6}{.8}$
\end{inner_problem}

$$\twomat{.6}{-.8}{.8}{.6}\twomat{.8}{-.6}{.6}{.8}=\twomat{0}{-1}{1}{0}.$$

This is a rotation of $\tan^{-1}\frac{3}{4} \approx 36.87^\circ$, followed by a rotation by $\tan^{-1}\frac{4}{3} \approx 53.13^\circ$.

\begin{center}
\begin{asy}[width=0.3\textwidth]
import graph;

dot((1,0));
dot((0,1));

label("$A$", (1,0),S);
label("$A'=B$", (0,1),SE);
label("$B'$",(-1,0),S);

dot((-1,0));
xaxis("$x$");
yaxis("$y$");
\end{asy}
\end{center}

\begin{inner_problem}
\item $\twomat{.6}{.8}{.8}{-.6}\twomat{.6}{.8}{.8}{-.6}$
\end{inner_problem}

$$\twomat{.6}{.8}{.8}{-.6}\twomat{.6}{.8}{.8}{-.6}=\twomat{-0.28}{-0.96}{0.96}{0.28}.$$

This is a rotation of $\tan^{-1}\frac{4}{3} \approx 53.13^\circ$, followed by another rotation of $\tan^{-1}\frac{4}{3}$.

\begin{center}
\begin{asy}[width=0.4\textwidth]
graphMatrix(-0.28,-0.96,0.96,0.28);
\end{asy}
\end{center}

\begin{inner_problem}
\item $\twomat{.6}{.8}{.8}{-.6}\twomat{.8}{.6}{.6}{-.8}$
\end{inner_problem}

$$\twomat{.6}{.8}{.8}{-.6}\twomat{.8}{.6}{.6}{-.8}=\twomat{0.96}{-0.28}{0.28}{0.96}.$$

This is a reflection about the line $\theta = \frac{1}{2}\tan^{-1}\frac{3}{4}\approx 18.43^\circ$, followed by a reflection about the line $\theta = \frac{1}{2}\tan^{-1}\frac{4}{3}\approx 26.57^\circ$.

\begin{center}
\begin{asy}[width=0.3\textwidth]
graphMatrix(0.96,-0.28,0.28,0.96);
\end{asy}
\end{center}

\begin{outer_problem}
\item A \textbf{linear mapping} $f$ is one in which all lines are mapped to lines and the origin remains a fixed point. Algebraically, $f\left(\left[\begin{smallmatrix}x \\ y \end{smallmatrix}\right]\right)=xf\left(\left[\begin{smallmatrix}1 \\ 0 \end{smallmatrix}\right]\right)+yf\left(\left[\begin{smallmatrix}0 \\ 1 \end{smallmatrix}\right]\right).$ I claim that we can build any linear mapping of the plane by multiplying together some combination of the matrices from Problem~\ref{prob:list_transformations}. Only two classes of matrix, however, are necessary; all other matrices are products or examples of these. Which two classes of matrix do you think comprise the minimum set from which the others can be composed? Be able to justify your choice.
\end{outer_problem}

(Answers may vary.) Stretches and shears seem like the most general classes of transformations. After all, they can be done in two directions, and unlike reflections and rotations, don't include an ``angle''; they have an infinite range of possibilities. Of course, I have the benefit of foresight.

\begin{outer_problem}
\item Write matrix products that perform the following mappings. Do the indicated multiplication and graph the preimage and image when applied to $(1,0)$ and $(0,1)$.
\end{outer_problem}

\begin{inner_problem}[start=1]
\item Rotation by $135^\circ$ followed by a shear by a factor of $\frac{1}{2}$ \textit{perpendicular} to the $y$-axis \label{prob:matrix_prod_start}
\end{inner_problem}

The matrix multiplication is as follows:

$$\twomat{1}{\frac{1}{2}}{0}{1}\twomat{\cos 135^\circ}{-\sin 135^\circ}{\sin 135^\circ}{\cos 135^\circ} = \twomat{1}{\frac{1}{2}}{0}{1}\twomat{-\frac{\sqrt{2}}{2}}{-\frac{\sqrt{2}}{2}}{\frac{\sqrt{2}}{2}}{-\frac{\sqrt{2}}{2}} = \twomat{-\frac{\sqrt{2}}{4}}{-\frac{3\sqrt{2}}{4}}{\frac{\sqrt{2}}{2}}{-\frac{\sqrt{2}}{2}}.$$

Note that a shear \textit{perpendicular} to the $y$-axis is \textit{parallel} with the $x$-axis. The graph is below.

\begin{center}
\begin{asy}[width=0.5\textwidth]
graphMatrix(-sqrt(2)/4,-3*sqrt(2)/2,sqrt(2)/2,-sqrt(2)/2);
\end{asy}
\end{center}

\begin{inner_problem}
\item Same transformations as in (a), but reversed
\end{inner_problem}

The matrix multiplication is as follows:

$$\twomat{-\frac{\sqrt{2}}{2}}{-\frac{\sqrt{2}}{2}}{\frac{\sqrt{2}}{2}}{-\frac{\sqrt{2}}{2}}\twomat{1}{\frac{1}{2}}{0}{1} = \twomat{-\frac{\sqrt{2}}{2}}{-\frac{3\sqrt{2}}{2}}{\frac{\sqrt{2}}{2}}{\frac{\sqrt{2}}{4}}.$$

The graph is below.

\begin{center}
\begin{asy}[width=0.3\textwidth]
graphMatrix(-sqrt(2)/2,-3*sqrt(2)/2,sqrt(2)/2,sqrt(2)/4);
\end{asy}
\end{center}

\begin{inner_problem}
\item Stretch in the $y$ direction by a factor of $3$ followed by a rotation of $60^\circ$
\end{inner_problem}

The matrix multiplication is as follows:

$$\twomat{\cos 60^\circ}{-\sin 60^\circ}{\sin 60^\circ}{\cos 60^\circ}\twomat{1}{0}{0}{3} = \twomat{\frac{1}{2}}{-\frac{\sqrt{3}}{2}}{\frac{\sqrt{3}}{2}}{\frac{1}{2}}\twomat{1}{0}{0}{3} = \twomat{\frac{1}{2}}{-\frac{3\sqrt{3}}{2}}{\frac{\sqrt{3}}{2}}{\frac{3}{2}}.$$

\begin{center}
\begin{asy}[width=0.3\textwidth]
graphMatrix(1/2,-3*sqrt(3)/2,sqrt(3)/2,3/2);
\end{asy}
\end{center}

\begin{inner_problem}
\item Same transformations as in (c), but reversed
\end{inner_problem}

The matrix multiplication is as follows:

$$\twomat{1}{0}{0}{3}\twomat{\frac{1}{2}}{-\frac{\sqrt{3}}{2}}{\frac{\sqrt{3}}{2}}{\frac{1}{2}} = \twomat{\frac{1}{2}}{-\frac{\sqrt{3}}{2}}{\frac{3\sqrt{3}}{2}}{\frac{3}{2}}.$$

\begin{center}
\begin{asy}[width=0.17\textwidth]
graphMatrix(1/2,-sqrt(3)/2,3*sqrt(3)/2,3/2);
\end{asy}
\end{center}

\begin{inner_problem}
\item Projection onto the line $y=5x$
\end{inner_problem}

We might think that any old matrix like $\twomat{1}{1}{5}{5}$, which takes every point to a point on the line $y=5x$, may work. This matrix, however, is not a \textit{projection}. In a projection to a line, the image of a point is the foot of the altitude from the point to the line.

To map every point onto $y=5x$, the matrix must be of the form $c\twomat{1}{1}{5}{5}$ for some real constant $c$. To make it a true projection, we choose a point that's already on $y=5x$ and note that it must map to itself. In this case, we'll choose $(1,5)$. then

$$c\twomat{1}{1}{5}{5}\begin{bmatrix} 1 \\ 5\end{bmatrix} = \begin{bmatrix} 1 \\ 5\end{bmatrix}$$
$$c\begin{bmatrix} 6 \\ 30 \end{bmatrix} = \begin{bmatrix} 1 \\ 5 \end{bmatrix}$$
$$\Longrightarrow c = \frac{1}{6}.$$

Thus, the transformation matrix is $\twomat{\frac{1}{6}}{\frac{1}{6}}{\frac{5}{6}}{\frac{5}{6}}$.

\begin{center}
\begin{asy}[width=0.27\textwidth]
import graph;

real a = 1/6;
real b = 1/6;
real c = 5/6;
real d = 5/6;

dot((1,0));
dot((0,1));

label("$A$", (1,0), N);
label("$B$", (0,1), E);

label("$A'=B'$", (a,c), SE);

dot((a,c));
dot((b,d));

xaxis("$x$");
yaxis("$y$");
\end{asy}
\end{center}

\begin{inner_problem}
\item Reflection over $\theta=\frac{\pi}{12}$ followed by a stretch in the $x$ direction by a factor of $2$
\end{inner_problem}

We recall that a reflection over the line $\theta=\phi$ is the matrix $\twomat{\cos 2\phi}{\sin 2\phi}{\sin 2\phi}{-\cos 2\phi}$. Substituting $\phi = \frac{\pi}{12}$ yields the matrix

$$\twomat{\cos \frac{\pi}{6}}{\sin \frac{\pi}{6}}{\sin \frac{\pi}{6}}{-\cos \frac{\pi}{6}}=\twomat{\frac{\sqrt{3}}{2}}{\frac{1}{2}}{\frac{1}{2}}{\frac{\sqrt{3}}{2}}.$$

Stretching in the $x$ direction by a factor of $2$ is just $\twomat{2}{0}{0}{1}$. Thus, the total transformation matrix is

$$\twomat{2}{0}{0}{1}\twomat{\frac{\sqrt{3}}{2}}{\frac{1}{2}}{\frac{1}{2}}{\frac{\sqrt{3}}{2}} = \twomat{\sqrt{3}}{1}{\frac{1}{2}}{\frac{\sqrt{3}}{2}}.$$

\begin{center}
\begin{asy}[width=0.3\textwidth]
graphMatrix(sqrt(3),1,1/2,sqrt(3)/2);
\end{asy}
\end{center}

\begin{inner_problem}
\item Same transformations as in (f), but reversed \label{prob:matrix_prod_end}
\end{inner_problem}

$$\twomat{\frac{\sqrt{3}}{2}}{\frac{1}{2}}{\frac{1}{2}}{\frac{\sqrt{3}}{2}}\twomat{2}{0}{0}{1} = \twomat{\sqrt{3}}{\frac{1}{2}}{1}{\frac{\sqrt{3}}{2}}$$

\begin{center}
\begin{asy}[width=0.3\textwidth]
graphMatrix(sqrt(3),1/2,1,sqrt(3)/2);
\end{asy}
\end{center}

\begin{outer_problem}
\item Write a set of matrices which undoes Problems~\ref{prob:matrix_prod_start} to~\ref{prob:matrix_prod_end}. You will find one of them impossible to undo; explain why.
\end{outer_problem}

\begin{inner_problem}[start=1]
\item Rotation by $135^\circ$ followed by a shear by a factor of $\frac{1}{2}$ \textit{perpendicular} to the $y$-axis \label{prob:matrix_prod_start}
\end{inner_problem}

We shear by $-\frac{1}{2}$ along the $x$-axis, then rotate $-135^\circ$.

$$\twomat{\cos -135^\circ}{-\sin -135^\circ}{\sin -135^\circ}{\cos -135^\circ}\twomat{1}{-\frac{1}{2}}{0}{1} = \twomat{\frac{\sqrt{2}}{2}}{\frac{\sqrt{2}}{2}}{-\frac{\sqrt{2}}{2}}{\frac{\sqrt{2}}{2}}\twomat{1}{-\frac{1}{2}}{0}{1} = \twomat{-\frac{\sqrt{2}}{2}}{\frac{3\sqrt{2}}{4}}{-\frac{\sqrt{2}}{2}}{\frac{\sqrt{2}}{4}}$$

\begin{inner_problem}
\item Same transformations as in (a), but reversed
\end{inner_problem}

We rotate $-135^\circ$, then shear by $-\frac{1}{2}$ along the $x$-axis.

$$\twomat{1}{\frac{1}{2}}{0}{1}\twomat{-\frac{\sqrt{2}}{2}}{-\frac{\sqrt{2}}{2}}{\frac{\sqrt{2}}{2}}{-\frac{\sqrt{2}}{2}} = \twomat{-\frac{\sqrt{2}}{2}}{-\frac{3\sqrt{2}}{4}}{\frac{\sqrt{2}}{2}}{-\frac{\sqrt{2}}{4}}.$$

\begin{inner_problem}
\item Stretch in the $y$ direction by a factor of $3$ followed by a rotation of $60^\circ$
\end{inner_problem}

We rotate by $-60^\circ$, then stretch by $\frac{1}{3}$ in the $y$ direction.

$$\twomat{1}{0}{0}{\frac{1}{3}}\twomat{\cos -60^\circ}{-\sin -60^\circ}{\sin -60^\circ}{\cos -60^\circ} = \twomat{1}{0}{0}{\frac{1}{3}}\twomat{\frac{1}{2}}{\frac{\sqrt{3}}{2}}{-\frac{\sqrt{3}}{2}}{\frac{1}{2}} = \twomat{\frac{1}{2}}{\frac{\sqrt{3}}{2}}{-\frac{\sqrt{3}}{6}}{\frac{1}{6}}.$$

\begin{inner_problem}
\item Same transformations as in (c), but reversed
\end{inner_problem}

We stretch by $1/3$ in the $y$ direction, then rotate by $-60^\circ$.

$$\twomat{\frac{1}{2}}{-\frac{\sqrt{3}}{2}}{\frac{\sqrt{3}}{2}}{\frac{1}{2}}\twomat{1}{0}{0}{1/3} = \twomat{\frac{1}{2}}{-\frac{\sqrt{3}}{6}}{\frac{\sqrt{3}}{2}}{\frac{1}{6}}.$$

\begin{inner_problem}
\item Projection onto the line $y=5x$
\end{inner_problem}

This matrix doesn't have an inverse, because multiple points map to the same point. For example, both $(0,0)$ and $(5,-1)$ project to $(0,0)$

\begin{inner_problem}
\item Reflection over $\theta=\frac{\pi}{12}$ followed by a stretch in the $x$ direction by a factor of $2$
\end{inner_problem}

We stretch by a factor of $\frac{1}{2}$ in the $x$ direction, then apply our old reflection matrix:

$$\twomat{\frac{\sqrt{3}}{2}}{\frac{1}{2}}{\frac{1}{2}}{\frac{\sqrt{3}}{2}}\twomat{\frac{1}{2}}{0}{0}{1} = \twomat{\frac{\sqrt{3}}{4}}{\frac{1}{2}}{\frac{1}{4}}{\frac{\sqrt{3}}{2}}.$$

\begin{inner_problem}
\item Same transformations as in (f), but reversed \label{prob:matrix_prod_end}
\end{inner_problem}

We first apply our old reflection matrix, then stretch by a factor of $\frac{1}{2}$ in the $x$ direction:

$$\twomat{\frac{1}{2}}{0}{0}{1}\twomat{\frac{\sqrt{3}}{2}}{\frac{1}{2}}{\frac{1}{2}}{\frac{\sqrt{3}}{2}} = \twomat{\frac{\sqrt{3}}{4}}{\frac{1}{4}}{\frac{1}{2}}{\frac{\sqrt{3}}{2}}.$$

\begin{outer_problem}
\item
\end{outer_problem}

\begin{inner_problem}[start=1]
\item Find the height of the parallelogram in Figure~\ref{fig:parallelogram_generic} in terms of $b$ and a trig function in terms of $\varphi$.
\end{inner_problem}

We see that $\sin\varphi = h/b$, so $h = b\sin\varphi$.

\begin{inner_problem}
\item Find the area of the parallelogram in terms of $a$, $b$, and $\varphi$.
\end{inner_problem}

Let $A$ be the area of the parallelogram. We have $A=ah$, and using information from the previous problem, we know that $A = ab\sin\varphi$.

\begin{figure}[h]
\begin{minipage}{0.33\textwidth}
\begin{asy}[width=\textwidth]
pair A = (0,0);
pair B = (4,4);
pair D = (8,0);
pair C = B+D;
draw(A--B--C--D--cycle);
draw(B--(4,0));

label("$\varphi$", A, 2.8*ENE);
draw(arc((0,0), point(A--D, 0.25), point(A--B,0.25)));
label("$h$", (4,2),W);
label("$b$", A--B, NW);

path a_brace = shift(0,-0.2)*brace(D,A);
draw(a_brace);

draw((4,0.6)--(3.4,0.6)--(3.4,0));

label("$a$", a_brace, S);
\end{asy}
\caption{A parallelogram.}
\label{fig:parallelogram_generic}
\end{minipage}\hfill
\begin{minipage}{0.33\textwidth}
\begin{asy}[width=\textwidth]
pair A = (0,0);
pair B = (4,4);
pair D = (8,0);
pair C = B+D;

path a_brace = rotate(20.0)*shift(0,-0.74)*brace(D,A);
path angle_mark = arc((0,0), point(A--D,0.25), rotate(20.0)*point(A--B, 0.25));
path angle_mark2 = arc((0,0), point(A--D,0.32), rotate(20.0)*point(A--D, 0.25));

A = rotate(20.0)*A;
B = rotate(20.0)*B;
C = rotate(20.0)*C;
D = rotate(20.0)*D;

draw(A--B--C--D--cycle);
draw(B--rotate(20.0)*(4,0));

draw(angle_mark,Arrow);
draw(angle_mark2);
label("$h$", rotate(20.0)*(4,2),NE);
label("$b$", rotate(20.0)*A--B, NW);

draw(a_brace);
draw(rotate(20.0)*((4,0.6)--(3.4,0.6)--(3.4,0)));

label("$a$", a_brace, rotate(20.0)*S);
label("$\theta$", angle_mark2, ENE);
label("$\phi$", angle_mark, ENE);

draw((-2,0)--(10,0),Arrow);
draw((0,-2)--(0,8),Arrow);

label("$P$", A, SW);
label("$Q$", B, NW);
label("$R$", C, NE);
label("$S$", D, ESE);
\end{asy}
\caption{The parallelogram in the $xy$ plane.}
\label{fig:para_in_xy}
\end{minipage}
\end{figure}

\begin{outer_problem}
\item In Figure~\ref{fig:para_in_xy}, we have put our parallelogram onto the $xy$ plane so that the side of length $a$ makes an angle of $\theta$ with the $x$ axis and $b$ makes an angle of $\phi$ with the $x$ axis. Thus, $\varphi=\phi-\theta$.
\end{outer_problem}

\begin{inner_problem}[start=1]
\item Rewrite the equation for the area of the parallelogram in terms of $\theta$ and $\phi$.
\end{inner_problem}

We substitute $\varphi = \phi - \theta$ to find that $A = ab\sin(\phi - \theta)$.

\begin{inner_problem}
\item Find the $x$ and $y$ coordinates of $P,Q,R,S$ in terms of $a$, $b$, $\phi$, $\theta$.
\end{inner_problem}

The vector $\overrightarrow{PS}$ is just $\langle a\cos \theta, a\sin\theta \rangle$, and the vector $\overrightarrow{PQ}$ is just $\langle b\cos\phi, b\sin\phi \rangle$. Thus, we have the following coordinates for $P,Q,R,S$:

$$P = (0,0);\quad Q = P+\overrightarrow{PQ} = (b\cos\phi, b\sin\phi);\quad R = P+\overrightarrow{PQ}+\overrightarrow{PS} = (a\cos\theta + b\cos\phi, a\sin\theta + b\sin\phi);\quad S = P+\overrightarrow{PS} = (a\cos\theta, a\sin\theta).$$

\begin{inner_problem}
\item Write a matrix so that the first column contains the coordinates of $Q$ and the second column contains the coordinates of $S$. This matrix maps the plane.
\end{inner_problem}

The matrix is $M=\twomat{b\cos\phi}{a\cos\theta}{b\sin\phi}{a\sin\theta}$.

\begin{inner_problem}
\item Your matrix has two diagonals. One rises from left to right and the other descends from left to right. Subtract the product of the entries of the ascending diagonal from the product of those of the descending diagonal.
\end{inner_problem}

This is $ab\cos\phi\sin\theta - ab\cos\theta\sin\phi$.

\begin{inner_problem}
\item Use angle addition formulas to simplify your answer.
\end{inner_problem}

$$ab\cos\phi\sin\theta - ab\cos\theta\sin\phi = ab(\cos\phi\sin\theta - \cos\theta\sin\phi) = ab\sin(\theta-\phi).$$

\begin{inner_problem}
\item You should find some relationship between your answers to problems 11a and 11d. What is it?
\end{inner_problem}

The answers have the same magnitude, but opposite sign. Indeed, $-ab\sin(\theta-\phi) = ab\sin(\phi-\theta)$.

\begin{inner_problem}
\item The difference of the products of the two diagonals of a $2\times 2$ matrix is called the \textbf{determinant} of the matrix, written $\det \left[\begin{smallmatrix}a & c \\ b & d \end{smallmatrix}\right]=ad-bc$. What does it measure?
\end{inner_problem}

It measures the area (in terms of magnitude) of the parallelogram formed by the two vectors $\langle a,b\rangle$ and $\langle c,d\rangle$.

\begin{inner_problem}
\item Find a matrix which produces a rotation. What is its determinant?
\end{inner_problem}

$\twomat{0}{-1}{1}{0}$ is such a matrix. It has a determinant of $(0)(0)-(-1)(1)=1$.

\begin{inner_problem}
\item Find a matrix that produces a reflection.
\end{inner_problem}

$\twomat{-1}{0}{0}{1}$ is such a matrix. It has a determinant of $(-1)(1)-(0)(0)=-1$.

\begin{iinner_problem}
\item What is the absolute value of its determinant?
\end{inner_problem}

The absolute value of its determinant is $|-1|=1$.

\begin{iinner_problem}
\item How does its determinant differ from that of a rotation matrix?
\end{inner_problem}

It is negative, while a rotation matrix's determinant is positive.

\begin{iinner_problem}
\item What property is not conserved under reflection?
\end{inner_problem}

Orientation (or ``handedness,'' ``chirality,'' whatever you want to call it) is not preserved.

\begin{inner_problem}
\item Find a matrix which produces a dilation.
\end{inner_problem}

$\twomat{a}{0}{0}{a}$ is such a matrix; it dilates by a factor of $a$.

\begin{iinner_problem}[start=1]
\item What is its determinant?
\end{iinner_problem}

Its determinant is $a(a) - 0(0)=a^2$.

\begin{iinner_problem}
\item What does the size of its determinant indicate?
\end{iinner_problem}

It indicates the factor by which the area of the unit square is scaled up in the transformation.

\begin{inner_problem}
\item What does the size of a determinant indicate?
\end{inner_problem}

This size of a determinant indicates the amount by which areas will be scaled by. If it is negative, than the orientation is changed. If it is zero, then the transformation is degenerate; it's a mapping to a line or the origin.

\begin{center}
\begin{minipage}{0.33\textwidth}
\begin{asy}[width=\textwidth]
import patterns;

add("brick",brick());

draw((0,0)--(7,0),Arrow);
draw((0,0)--(0,6),Arrow);

pair A = (0,0);
pair B = (1,3);
pair C = (6,5);
pair D = (5,2);

draw(A--B--C--D--cycle);
pair K1 = (0,3);
pair K2=(5,3);
pair K3 = (5,0);
pair L0 = (1,2);
pair L1 = (1,5);
pair L3 = (6,2);

draw(A--K1--K2--K3--cycle);
draw(L0--L1--C--L3--cycle);

filldraw(A--K1--B--cycle, pattern("brick"));
filldraw(A--K3--D--cycle, pattern("brick"));
filldraw(L0--B--K2--D--cycle, pattern("brick"));
filldraw(B--L1--C--cycle, pattern("brick"));
filldraw(D--C--L3--cycle, pattern("brick"));

label("$(a,b)$", B, NW);
label("$(c,d)$", D, SE);
label("$(a+c,b+d)$", C, N);

dot(B);
dot(D);
dot(C);

\end{asy}
\captionof{figure}{Scenario for Problem~\ref{prob:unit_square_into_parallelogram}.}
\label{fig:para_scenario}
\end{minipage}
\end{center}

\begin{outer_problem}
\item Here is another way to think about the area of the image of the unit square under a linear transformation. First, we use the matrix $\twomat{a}{c}{b}{d}$ to transform the unit square into a parallelogram. Then, we graph the image. \label{prob:unit_square_into_parallelogram}
\end{outer_problem}

\begin{inner_problem}[start=1]
\item There are three rectangles and four triangles in Figure~\ref{fig:para_scenario}. Find the dimensions and the area of each one. You can use this information to figure out the area of the parallelogram in terms of $a$, $b$, $c$, and $d$. Write a sentence or equation explaining how you can use the seven areas to find the area of the parallelogram.
\end{inner_problem}

Possible sentence: The area of the parallelogram is the sum of the areas of the two big rectangles, minus the sum of all the areas shaded in bricks.
Possible equation: $A_{\text{parallelogram}}=A_{\text{large rectangles}}-A_{\text{triangles}}-A_{\text{small rectangle}}.$

\begin{inner_problem}
\item Carry out the algebra to find the area.
\end{inner_problem}

The large rectangles are each $c$ units wide and $b$ units tall, so they have a total area of $2bc$. There are two sets of two congruent triangles here. We can combine each set together to create two rectangles with an area of $ab$ and $cd$, respectively. Finally, the small rectangle has area $(c-a)(b-d)$. The area of the parallelogram is

$$2bc-(ab+cd)-(c-a)(b-d) = 2bc-(ab+cd) - (bc+ad-ab-cd) = bc-ad.$$

\begin{inner_problem}
\item Calculate the determinant of the matrix.
\end{inner_problem}

The determinant is $\det \begin{bmatrix} a & c \\ b & d \end{bmatrix} =ad-bc$.

\begin{inner_problem}
\item What is the relationship between the determinant of the matrix and the area of its associated parallelogram?
\end{inner_problem}

The determinant of the matrix is the area of its associated parallelogram negated. In mathematical terms, $A_{parallelogram}=bc-ad = -(ad-bc) = -\det \begin{bmatrix} a & c \\ b & d \end{bmatrix}$.

\begin{inner_problem}
\item Consider what happens if $(a,b)$ and $(c,d)$ switch places in the graph.
\end{inner_problem}

\begin{iinner_problem}[start=1]
\item How would the area you calculated be different?
\end{iinner_problem}

The new area would be $ad-bc$, and thus the negative of what it was before!

\begin{iinner_problem}
\item What property would now be preserved by the transformation?
\end{iinner_problem}

Orientation (or chirality or handedness whatever) would now be preserved.

\begin{iinner_problem}
\item What isometry would have been included in any composition of simple transformations yielding the mapping?
\end{iinner_problem}

Any such composition would require a reflection, because all the other simple transformations do not flip.

\begin{iinner_problem}
\item What would be true of the determinant?
\end{iinner_problem}

The determinant would be positive, since it is now equal to the (necessarily positive) area of the parallelogram.

\begin{inner_problem}
\item
\end{inner_problem}

\begin{iinner_problem}[start=1]
\item What does a reversal of the orientation of figure in its image say about the determinant of the transformation matrix?
\end{iinner_problem}

It says that the determinant is negative.

\begin{iinner_problem}
\item What does that same property of the determinant imply that a transformational matrix does?
\end{iinner_problem}

It implies that a transformation matrix reverses the orientation of a figure.

\begin{iinner_problem}
\item What isometry reverses orientation?
\end{iinner_problem}

Reflections reverse orientation; rotations don't.

\begin{inner_problem}
\item
\end{inner_problem}

\begin{iinner_problem}[start=1]
\item What would have happened to the parallelogram if we replaced $c,d$ in the matrix with $kc,kd$ for some $k>0$, so that the transformation matrix is $\left[\begin{smallmatrix} a & kc \\ b & kd \end{smallmatrix}\right]$?
\end{iinner_problem}

The parallelogram would become scaled in the direction of $(c,d)$, by a factor of $k$. See the diagram:

\begin{center}
	\begin{asy}[width=0.4\textwidth]
	import patterns;

	add("brick",brick());

	draw((0,0)--(12,0),Arrow);
	draw((0,0)--(0,8),Arrow);

	real k = 1.7;

	pair A = (0,0);
	pair B = (1,3);
	pair C = (6,5);
	pair D = (5,2);
	pair kC = B+k*D;
	pair kD = k*D;

	draw(A--B--C--D--cycle,dashed);
	draw(B--kC--kD--A);

	label("$(a,b)$", B, NW);
	label("$(c,d)$", D, SE);
	label("$(a+c,b+d)$", C, NW);
	label("$(kc,kd)$", kD, SE);
	label("$(a+kc,b+kd)$", kC, NE);

	dot(B);
	dot(D);
	dot(C);
	dot(kD);
	dot(kC);

	\end{asy}
	\captionof{figure}{The parallelogram gets scaled by a factor of $k$. In this case, $k=1.7$.}
\end{center}

\begin{iinner_problem}
\item What would its area be?
\end{iinner_problem}

Its area would be scaled by a factor of $k$; it would be $k(bc-ad)$.

\begin{iinner_problem}
\item What would the determinant of the matrix be?
\end{iinner_problem}

The determinant of the matrix would be $k(ad-bc)$.

\begin{iinner_problem}
\item What if $\left[\begin{smallmatrix}b & d \end{smallmatrix}\right]=r\left[\begin{smallmatrix}a & c \end{smallmatrix}\right]$? That is, what if the second row of the matrix was a linear multiple of the first row?
\end{iinner_problem}

In this case, the the two vectors constructing the parallelogram are collinear. Thus, the transformation collapses to a line.

\begin{asydef}
void drawFor(real s_x, real s_y, real a, real c, real b, real d, real ap, real cp, real bp, real dp) {
	a *= s_x;
	c *= s_x;
	ap *= s_x;
	cp *= s_x;
	b *= s_y;
	d *= s_y;
	bp *= s_y;
	dp *= s_y;

	real max_x = 1.2*max(a,c,ap,cp,a+c,ap+cp);
	real min_x = 1.2*min(a,c,ap,cp,a+c,ap+cp,0);
	real max_y = 1.2*max(b,d,bp,dp,b+d,bp+dp,1.5);
	real min_y = 1.2*min(b,d,bp,dp,0,b+d,bp+dp);

	draw((min_x,0)--(max_x,0), Arrow);
	draw((0,min_y)--(0,max_y), Arrow);

	draw((0,0)--(a,b)--(a+c,b+d)--(c,d)--cycle, dashed);
	draw((0,0)--(ap,bp)--(ap+cp,bp+dp)--(cp,dp)--cycle);

	if (s_x != 1 || s_y != 1) {
		label("Not to scale", (0,max_y), NE);
	}
}
\end{asydef}

\begin{minipage}{0.5\textwidth}

\begin{minipage}{0.45\textwidth}
i.
\begin{asy}[width=\textwidth]
drawFor(1,1,2,3,4,1,2,3,4,1);
\end{asy}
\end{minipage}\hfill
\begin{minipage}{0.45\textwidth}
iii.
\begin{asy}[width=\textwidth]
drawFor(1,1,2,3,4,1,1,3/2,4,1);
\end{asy}
\end{minipage}

\begin{minipage}{0.45\textwidth}
iv.
\begin{asy}[width=\textwidth]
drawFor(3,1,1,3/2,4,1,1,3/2,0,-5);
\end{asy}
\end{minipage}\hfill
\begin{minipage}{0.45\textwidth}
v.
\begin{asy}[width=\textwidth]
drawFor(3,1,1,3/2,0,-5,1,3/2,0,1);
\end{asy}
\end{minipage}

\begin{minipage}{0.5\textwidth}
vi.
\begin{asy}[width=\textwidth]
drawFor(1,1,1,3/2,0,1,1,0,0,1);
\end{asy}
\end{minipage}
\begin{minipage}{0.45\textwidth}
\captionof{figure}{The undoing steps, visualized.}
\label{fig:undo_matrix}
\end{minipage}

\end{minipage}\hfill
\begin{minipage}{0.5\textwidth}
\begin{enumerate}[label=\roman*.]
\item The determinant is not $0$, so we continue.
\item $a\neq 0$, so we continue.
\item $\twomat{\frac{1}{2}}{0}{0}{1}\twomat{2}{3}{4}{1}=\twomat{1}{\frac{3}{2}}{4}{1}.$
\item $\twomat{1}{0}{-4}{1}\twomat{1}{\frac{3}{2}}{4}{2}=\twomat{1}{\frac{3}{2}}{0}{-5}.$
\item $\twomat{1}{0}{0}{-\frac{1}{5}}\twomat{1}{\frac{3}{2}}{0}{5}=\twomat{1}{\frac{3}{2}}{0}{1}.$
\item $\twomat{1}{-\frac{3}{2}}{0}{1}\twomat{1}{\frac{3}{2}}{0}{1}=\twomat{1}{0}{0}{1}.$
\end{enumerate}
\end{minipage}

\begin{outer_problem}
\item Look at Figure~\ref{fig:undo_matrix} and describe the transformation in each step.
\end{outer_problem}

iii. We stretch by a factor of $\frac{1}{2}$ in the $x$ direction.
iv. We shear by a factor of $-4$ in the $y$ direction (perpendicular to the $x$ direction).
v. We stretch by a factor of $-\frac{1}{5}$ in the $y$ direction.
vi. We shear by a factor of $-\frac{1}{2}$ in the $x$ direction.

\begin{outer_problem}
\item
\end{outer_problem}

\begin{inner_problem}[start=1]
\item How do you undo a shear in the $x$ direction?
$\blanktwomat\twomat{1}{s}{0}{1}=\twomat{1}{0}{0}{1}$
\end{inner_problem}

$\twomat{1}{-s}{0}{1}\twomat{1}{s}{0}{1}=\twomat{1}{0}{0}{1}.$

\begin{inner_problem}
\item How do you undo a stretch along the $x$ axis?
$\blanktwomat\twomat{x}{0}{0}{1}=\twomat{1}{0}{0}{1}$
\end{inner_problem}

$\twomat{\frac{1}{x}}{0}{0}{1}\twomat{x}{0}{0}{1}=\twomat{1}{0}{0}{1}.$

\begin{inner_problem}
\item How do you undo a shear in the $y$ direction?
$\blanktwomat\twomat{1}{0}{s}{1}=\twomat{1}{0}{0}{1}$
\end{inner_problem}

$\twomat{1}{0}{-s}{1}\twomat{1}{0}{s}{1}=\twomat{1}{0}{0}{1}.$

\begin{inner_problem}
\item How do you undo a stretch along the $y$ axis?
$\blanktwomat\twomat{1}{0}{0}{y}=\twomat{1}{0}{0}{1}$
\end{inner_problem}

$\twomat{1}{0}{0}{\frac{1}{y}}\twomat{1}{0}{0}{y}=\twomat{1}{0}{0}{1}.$

\begin{outer_problem}
\item Now let's put this all together. Undo each of the operations in turn, until only matrix $\left[\begin{smallmatrix}a & c \\ b & d \end{smallmatrix}\right]$ remains on the left side. Remember that what you do on the left side of the expression must also be done to the right side, so on the right side you will see the basic operations from which $\left[\begin{smallmatrix}a & c \\ b & d \end{smallmatrix}\right]$ is composed. Order is important!
\end{outer_problem}

\vspace{1.5cm}
$$\mathop{\blanktwomat}^{\tikzmark{a1}}
\mathop{\blanktwomat}^{\tikzmark{b1}}
\mathop{\blanktwomat}^{\tikzmark{c1}}
\mathop{\blanktwomat}^{\tikzmark{d1}}
\mathop{\twomat{1}{-\frac{c}{a}}{0}{1}}^{\tikzmark{d2}}
\mathop{\twomat{1}{0}{0}{\frac{a}{ad-bc}}}^{\tikzmark{c2}}
\mathop{\twomat{1}{0}{-b}{1}}^{\tikzmark{b2}}
\mathop{\twomat{\frac{1}{a}}{0}{0}{1}}^{\tikzmark{a2}}
\twomat{a}{c}{b}{d}$$
$$\Longrightarrow \blanktwomat\blanktwomat\blanktwomat\blanktwomat\twomat{1}{0}{0}{1} = \twomat{a}{c}{b}{d}$$

\tikz[remember picture,auto]{
\path[overlay, ->] (pic cs:a1) edge [bend left] node {undoes} (pic cs:a2);
\path[overlay, ->] (pic cs:b1) edge [bend left] node {undoes} (pic cs:b2);
\path[overlay, ->] (pic cs:c1) edge [bend left] node {undoes} (pic cs:c2);
\path[overlay, ->] (pic cs:d1) edge [bend left] node {undoes} (pic cs:d2);
}

These are the matrices all filled in:

$$\twomat{a}{0}{0}{1}\twomat{1}{0}{b}{1}\twomat{1}{0}{0}{\frac{ad-bc}{a}}\twomat{1}{\frac{c}{a}}{0}{1}\twomat{1}{0}{0}{1} = \twomat{a}{c}{b}{d}$$

\begin{outer_problem}
\item \label{prob:needed_for_matrix_undo1}Each step in the decomposition of $\twomat{3}{4}{2}{-5}$ is explained below.
\begin{multicols}{2}
\begin{enumerate}[label=(\roman*)]
\item Stretch along the $x$ axis by factor of $\frac{1}{3}$.
$$\twomat{\frac{1}{3}}{0}{0}{1}\twomat{3}{4}{2}{-5}=\twomat{1}{\frac{4}{3}}{2}{-5}$$
\item Shear perpendicular to the $x$ axis by $-2$
$$\twomat{1}{0}{-2}{1}\twomat{1}{\frac{4}{3}}{2}{-5}=\twomat{1}{\frac{4}{3}}{0}{-\frac{23}{3}}$$
\item Stretch along $y$ axis by $-\frac{3}{23}$
$$\twomat{1}{0}{0}{-\frac{3}{23}}\twomat{1}{\frac{4}{3}}{0}{-\frac{23}{3}}=\twomat{1}{\frac{4}{3}}{0}{1}$$
\item Shear perpendicular to the $y$ axis by $-\frac{4}{3}$
$$\twomat{1}{-\frac{4}{3}}{0}{1}\twomat{1}{\frac{4}{3}}{0}{1}=\twomat{1}{0}{0}{1}$$
\end{enumerate}
\end{multicols}
Taken all together, the decomposition is:
$$\twomat{1}{-\frac{4}{3}}{0}{1}\twomat{1}{0}{0}{-\frac{3}{23}}\twomat{1}{0}{-2}{1}\twomat{\frac{1}{3}}{0}{0}{1}\twomat{3}{4}{2}{-5}.$$
Therefore: $$\twomat{3}{4}{2}{-5}=\twomat{3}{0}{0}{1}\twomat{1}{0}{2}{1}\twomat{1}{0}{0}{-\frac{23}{3}}\twomat{1}{\frac{4}{3}}{0}{1}.$$ What does each matrix do?
\end{outer_problem}

Going from right to left, the first matrix shears by $\frac{4}{3}$ in the $x$ direction (perpendicular to the $y$ axis). The second matrix stretches by $-\frac{23}{3}$ in the $y$ direction. The third matrix shears by $2$ in the $y$ direction (perpendicular to the $x$ axis). The fourth and final matrix stretches by $3$ in the $x$ direction.

\begin{outer_problem}
\setcounter{problem_i}{\value{outer_problemi}}
\item\label{prob:needed_for_matrix_undo2}Here is another way that you could have decomposed the above matrix.
\vspace{-2ex}
$$\mathop{\twomat{1}{0}{0}{\frac{13}{23}}}^{\text{i}}
\mathop{\twomat{1}{-\frac{2}{23}}{0}{1}}^{\text{ii}}
\mathop{\twomat{\frac{1}{\sqrt{13}}}{0}{0}{\frac{1}{\sqrt{13}}}}^{\text{iii}}
\mathop{\twomat{\frac{3}{\sqrt{13}}}{-\frac{2}{\sqrt{13}}}{\frac{2}{\sqrt{13}}}{\frac{3}{\sqrt{13}}}}^{\text{iv}}
\mathop{\twomat{1}{0}{0}{-1}}^{\text{v}}
\twomat{3}{4}{2}{-5}=\twomat{1}{0}{0}{1}.$$
\end{outer_problem}

\begin{inner_problem}[start=1]
\item Identify what matrices i through v each do.
\end{inner_problem}

i scales by $\frac{13}{23}$ along the $y$-axis. ii shears by $-\frac{2}{23}$. iii scales by $\frac{1}{\sqrt{13}}$. iv rotates by $\tan^{-1} \frac{2}{3}$. $v$ reflects over the $x$-axis (since the $y$ coordinate is being flipped).

\begin{outer_problem } % space is used to confuse compare_books
\setcounter{outer_problemi}{\value{problem_i}}
\item (cont.) Next, we undo this sequence of operations by working backwards.
\end{outer_problem }

\vspace{-2ex}
$$\mathop{\twomat{1}{0}{0}{-1}}^{\text{i}}
\mathop{\twomat{\frac{3}{\sqrt{13}}}{\frac{2}{\sqrt{13}}}{-\frac{2}{\sqrt{13}}}{\frac{3}{\sqrt{13}}}}^{\text{ii}}
\mathop{\twomat{\sqrt{13}}{0}{0}{\sqrt{13}}}^{\text{iii}}
\mathop{\twomat{1}{\frac{2}{23}}{0}{1}}^{\text{iv}}
\mathop{\twomat{1}{0}{0}{\frac{23}{13}}}^{\text{v}}
\twomat{1}{0}{0}{1}=\twomat{3}{4}{2}{-5}.$$

\begin{inner_problem}
\item Explain what happens at each matrix, i through v.
\end{inner_problem}

i reflects over the $x$-axis, since the $y$ coordinate is being flipped. ii rotates by $-\tan^{-1} \frac{2}{3}$. iii scales by $\sqrt{13}$. iv shears by $\frac{2}{23}$ along the $x$-axis. Finally, v scales by $\frac{23}{13}$.

\begin{outer_problem}
\item Find a set of basic transformations which is equivalent to each of the following matrices.\label{prob:basic_transformations}
\end{outer_problem}

\begin{inner_problem}[start=1]
\item $\twomat{12}{8}{5}{15}$
\end{inner_problem}

(Answers may vary.)

Using the method we described, we first stretch along the $x$-axis by $\frac{1}{12}$:

$$\twomat{\frac{1}{12}}{0}{0}{1}\twomat{12}{8}{5}{15} = \twomat{1}{\frac{3}{4}}{5}{15}.$$

We then shear along the $y$-axis by $-5$:

$$\twomat{1}{0}{-5}{1}\twomat{\frac{1}{12}}{0}{0}{1}\twomat{12}{8}{5}{15} = \twomat{1}{\frac{3}{4}}{0}{\frac{45}{4}}.$$

We then stretch along the $y$-axis by $\frac{4}{45}$:

$$\twomat{1}{0}{0}{\frac{4}{45}}\twomat{1}{0}{-5}{1}\twomat{\frac{1}{12}}{0}{0}{1}\twomat{12}{8}{5}{15} = \twomat{1}{\frac{3}{4}}{0}{1}.$$

Finally, we shear by $-\frac{3}{4}$ along the $x$-axis:

$$\twomat{1}{-\frac{3}{4}}{0}{1}\twomat{1}{0}{0}{\frac{4}{45}}\twomat{1}{0}{-5}{1}\twomat{\frac{1}{12}}{0}{0}{1}\twomat{12}{8}{5}{15} = \twomat{1}{0}{0}{1}.$$

Now we undo the operations in turn:

$$\underbrace{\twomat{12}{0}{0}{1}\twomat{1}{0}{5}{1}\twomat{1}{0}{0}{\frac{45}{4}}\twomat{1}{\frac{3}{4}}{0}{1}}\twomat{1}{-\frac{3}{4}}{0}{1}\twomat{1}{0}{0}{\frac{4}{45}}\twomat{1}{0}{-5}{1}\twomat{\frac{1}{12}}{0}{0}{1}\twomat{12}{8}{5}{15} = \twomat{1}{0}{0}{1}.$$
$$\Longrightarrow \twomat{12}{0}{0}{1}\twomat{1}{0}{5}{1}\twomat{1}{0}{0}{\frac{45}{4}}\twomat{1}{\frac{3}{4}}{0}{1} = \twomat{12}{8}{5}{15}.$$

\begin{inner_problem}
\item $\twomat{3}{24}{4}{7}$
\end{inner_problem}

(Answers may vary.)

Using the method we described, we first stretch along the $x$-axis by $\frac{1}{3}$:

$$\twomat{\frac{1}{3}}{0}{0}{1}\twomat{3}{24}{4}{7} = \twomat{1}{8}{4}{7}.$$

We then shear along the $y$-axis by $-4$:

$$\twomat{1}{0}{-4}{1}\twomat{\frac{1}{3}}{0}{0}{1}\twomat{3}{24}{4}{7} = \twomat{1}{8}{0}{-25}.$$

We then stretch along the $y$-axis by $-\frac{1}{25}$:

$$\twomat{1}{0}{0}{-\frac{1}{25}}\twomat{1}{0}{-4}{1}\twomat{\frac{1}{3}}{0}{0}{1}\twomat{3}{24}{4}{7} = \twomat{1}{8}{0}{1}.$$

Finally, we shear by $-8$ along the $x$-axis:

$$\twomat{1}{-8}{0}{1}\twomat{1}{0}{0}{-\frac{1}{25}}\twomat{1}{0}{-4}{1}\twomat{\frac{1}{3}}{0}{0}{1}\twomat{3}{24}{4}{7} = \twomat{1}{0}{0}{1}.$$

We undo the operations in turn:

$$\underbrace{\twomat{3}{0}{0}{1}\twomat{1}{0}{4}{1}\twomat{1}{0}{0}{-25}\twomat{1}{8}{0}{1}}\twomat{1}{-8}{0}{1}\twomat{1}{0}{0}{-\frac{1}{25}}\twomat{1}{0}{-4}{1}\twomat{\frac{1}{3}}{0}{0}{1}\twomat{3}{24}{4}{7}$$
$$\Longrightarrow \twomat{3}{0}{0}{1}\twomat{1}{0}{4}{1}\twomat{1}{0}{0}{-25}\twomat{1}{8}{0}{1} = \twomat{3}{24}{4}{7}.$$

\begin{inner_problem}
\item $\twomat{2}{3}{4}{6}$
\end{inner_problem}

This matrix can't be decomposed with our usual method! That's because it lacks an inverse transformation, since it's projecting to a line (namely, the line $y=2x$).

Let's think a bit more laterally here. What of our operations take the whole plane to a line? Shears don't, rotations and reflections don't, but stretches with a factor of $0$ can. For example, we can take everything to the $x$-axis with the matrix

$$\twomat{1}{0}{0}{0}.$$

Thus, we should be able to decompose our matrix as

$$A\twomat{1}{0}{0}{0}B=\twomat{2}{3}{4}{6}$$

for some matrices $A,B$. If we want to take the $x$-axis to the line $y=2x$, which is the job of matrix $A$ (remember, right to left!), we'll need $A$ to be a shear by a factor of $2$ along the $y$-axis. (See Figure~\ref{fig:shearing_A}.) Thus,

$$A=\twomat{1}{0}{2}{1}.$$

\begin{center}
	\begin{asy}[width=0.26\textwidth]
		import graph;

		draw((-1,-2)--(2,4),Arrows);
		draw((-1,0)--(2,0),Arrows);

		draw((1.2,0.3)--(1.2,2.1),Arrow);
		label("$A$",(1.2,1.2),E);

		xaxis("$x$",p=gray(0.7));
		yaxis("$y$",p=gray(0.7));
	\end{asy}
	\captionof{figure}{The shearing action of $A$ on the $x$-axis.}
	\label{fig:shearing_A}
\end{center}

To find $B$, we solve the matrix equation. We have $$\twomat{1}{0}{2}{1}\twomat{1}{0}{0}{0}B=\twomat{2}{3}{4}{6}$$
$$\twomat{1}{2}{0}{0}B=\twomat{2}{3}{4}{6}.$$

Let $B=\twomat{a}{b}{c}{d}$.

$$\twomat{1}{2}{0}{0}\twomat{a}{b}{c}{d}=\twomat{2}{3}{4}{6}.$$
$$\twomat{a}{b}{2a}{2b}=\twomat{2}{3}{4}{6}.$$

Interesting! $c,d$ can be any real numbers, because their effect is nullified by the mapping to a line. But $a=2$ and $b=3$. Let's just choose $c=0$ and $d=1$ for simplicity of decomposition. We have

$$\twomat{2}{3}{0}{1}=B$$
$$\twomat{\frac{1}{2}}{0}{0}{1}\twomat{2}{3}{0}{1}=\twomat{1}{\frac{3}{2}}{0}{1}$$
$$\twomat{1}{-\frac{3}{2}}{0}{1}\twomat{\frac{1}{2}}{0}{0}{1}\twomat{2}{3}{0}{1}=\twomat{1}{0}{0}{1}.$$

We undo the new matrices:

$$\twomat{2}{0}{0}{1}\twomat{1}{\frac{3}{2}}{0}{1}\twomat{1}{-\frac{3}{2}}{0}{1}\twomat{\frac{1}{2}}{0}{0}{1}\twomat{2}{3}{0}{1}=\twomat{1}{0}{0}{1}$$
$$\Longrightarrow \twomat{2}{0}{0}{1}\twomat{1}{\frac{3}{2}}{0}{1} = B.$$

Thus, our full decomposition is

$$\underbrace{\twomat{1}{0}{2}{1}}_{A}\twomat{1}{0}{0}{0}\underbrace{\twomat{2}{0}{0}{1}\twomat{1}{\frac{3}{2}}{0}{1}}_{B}=\twomat{2}{3}{4}{6}.$$

In words, this is a shear of $\frac{3}{2}$ along the $x$-axis, followed by a stretch of a factor of $2$ along the $x$-axis, a stretch of a factor of $0$ along the $y$-axis, and a shear of $2$ along the $y$-axis.

As an aside, here's what happens if you try using the usual method. We first stretch along the $x$-axis by $\frac{1}{2}$, then shear along the $y$-axis by $-2$:

$$\twomat{\frac{1}{2}}{0}{0}{1}\twomat{2}{3}{4}{6} = \twomat{1}{\frac{3}{2}}{2}{3}.$$
$$\twomat{1}{0}{-2}{1}\twomat{\frac{1}{2}}{0}{0}{1}\twomat{2}{3}{4}{6} = \twomat{1}{\frac{3}{2}}{0}{0}.$$

Here, our problem arises. We cannot make the bottom-right corner $1$.

\begin{outer_problem}
\item One of the matrices in Problem~\ref{prob:basic_transformations} is a projection onto a line.
\end{outer_problem}

\begin{inner_problem}[start=1]
\item Which matrix is it?
\end{inner_problem}

Problem (c): $\twomat{2}{3}{4}{6}$ is the matrix.

\begin{inner_problem}
\item What line does it project onto?
\end{inner_problem}

It projects onto the line $y=2x$.

\begin{inner_problem}
\item If you try to decompose this matrix to the identity matrix, what happens? Why?
\end{inner_problem}

You get stuck, because it lacks an inverse! The details are given as an aside at the end of that problem.

\begin{outer_problem}
\item Onto what line does $\left[\begin{smallmatrix} a & b \\ 2a & 2b\end{smallmatrix}\right]$ map the plane? Solve for $a$ and $b$ such that the matrix projects perpendicular onto the line. You can do this because you know that a point on the line should not move under the projection and a point on a line perpendicular to the line has its image on the origin. Using this information you can set up two equations with two unknowns. \label{prob:project_the_plane}
\end{outer_problem}

This matrix projects points onto the line $y=2x$. To project perpendicular on the line, we do as the problem suggests. Consider the point $(1,2)$, which is on the line. If the transformation is a true projection, then the point should not move under the transformation. Thus,

$$\twomat{a}{b}{2a}{2b}\begin{bmatrix} 1 \\ 2 \end{bmatrix} = \begin{bmatrix} 1 \\ 2 \end{bmatrix}.$$

The left side expands out to $\begin{bmatrix} a+2b \\ 2a+4b \end{bmatrix}$. Thus, as long as $a+2b=1$, the matrix will be a projection onto $y=2x$. A simple example is $a=b=\frac{1}{3}$, so a possible matrix is

$$\begin{bmatrix}
\frac{1}{3} & \frac{1}{3} \\
\frac{2}{3} & \frac{2}{3}
\end{bmatrix}.$$

\begin{outer_problem}
\item Use Problem~\ref{prob:project_the_plane} to decompose $\left[\begin{smallmatrix} 2 & 3 \\ 4 & 6 \end{smallmatrix}\right]$ into a projection to a line followed by a size change.
\end{outer_problem}

We know $\begin{bmatrix}
\frac{1}{3} & \frac{1}{3} \\
\frac{2}{3} & \frac{2}{3}
\end{bmatrix}$ projects to the line $y=2x$. The desired matrix is just this matrix scaled by $6$. Thus, the decomposition is

$$\begin{bmatrix}6 & 0 \\ 0 & 6 \end{bmatrix} \begin{bmatrix}
\frac{1}{3} & \frac{1}{3} \\
\frac{2}{3} & \frac{2}{3}
\end{bmatrix}.$$

\begin{outer_problem}
\item Decompose $\left[\begin{smallmatrix} 1 & 2 \\ 3 & 6\end{smallmatrix}\right]$ into a projection perpendicular to a line followed by a size change.
\end{outer_problem}

This matrix maps onto the line $y=3x$, since it's of the form $\twomat{a}{b}{3a}{3b}$. We try a similar method as the last problem to find the matrix of a true projection, choosing the point $(1,3)$:

$$\twomat{a}{b}{3a}{3b}\begin{bmatrix} 1 \\ 3 \end{bmatrix} = \begin{bmatrix} 1 \\ 3 \end{bmatrix}$$
$$\begin{bmatrix} a + 3b \\ 3a + 9b \end{bmatrix} = \begin{bmatrix} 1 \\ 3 \end{bmatrix}.$$

So $a+3b = 1$. We just choose $a=b=\frac{1}{4}$ for simplicity, giving the projection matrix

$$\twomat{\frac{1}{4}}{\frac{1}{4}}{\frac{3}{4}}{\frac{3}{4}}.$$

Scaling this by $4$ gives the desired matrix, so the decomposition is

$$\twomat{4}{0}{0}{4}\twomat{\frac{1}{4}}{\frac{1}{4}}{\frac{3}{4}}{\frac{3}{4}}.$$

\begin{outer_problem}
\item Write matrices which project onto the following lines:
\end{outer_problem}

\begin{inner_problem}[start=1]
\item $y=x$
\end{inner_problem}

The matrix will be of the form $\twomat{a}{b}{a}{b}$. We choose the fixed point $(1,1)$:

$$\twomat{a}{b}{a}{b}\begin{bmatrix} 1 \\ 1 \end{bmatrix} = \begin{bmatrix} 1 \\ 1 \end{bmatrix}$$
$$\begin{bmatrix} a + b \\ a + b \end{bmatrix} = \begin{bmatrix} 1 \\ 1 \end{bmatrix}.$$

So $a+b=1$. For simplicity, we choose $a=b=\frac{1}{2}$, giving the matrix $$\twomat{\frac{1}{2}}{\frac{1}{2}}{\frac{1}{2}}{\frac{1}{2}}.$$

\begin{inner_problem}
\item $y=5x$
\end{inner_problem}

The matrix will be of the form $\twomat{a}{b}{5a}{5b}$. We choose the fixed point $(1,5)$:

$$\twomat{a}{b}{5a}{5b}\begin{bmatrix} 1 \\ 5 \end{bmatrix} = \begin{bmatrix} 1 \\ 5 \end{bmatrix}$$
$$\begin{bmatrix} a + 5b \\ 5a + 25b \end{bmatrix} = \begin{bmatrix} 1 \\ 5 \end{bmatrix}.$$

So $a+5b=1$. For simplicity, we choose $a=b=\frac{1}{6}$, giving the matrix $$\twomat{\frac{1}{6}}{\frac{1}{6}}{\frac{5}{6}}{\frac{5}{6}}.$$

\begin{inner_problem}
\item $y=mx$
\end{inner_problem}

This is pretty easy to generalize. The matrix will be of the form $\twomat{a}{b}{ma}{mb}$. We choose the fixed point $(1,m)$:

$$\twomat{a}{b}{ma}{mb}\begin{bmatrix} 1 \\ m \end{bmatrix} = \begin{bmatrix} 1 \\ m \end{bmatrix}$$
$$\begin{bmatrix} a + mb \\ ma + m^2b \end{bmatrix} = \begin{bmatrix} 1 \\ m \end{bmatrix}.$$

So $a+mb=1$. For simplicity, we choose $a=b=\frac{1}{m+1}$, giving the matrix $$\twomat{\frac{1}{m+1}}{\frac{1}{m+1}}{\frac{m}{m+1}}{\frac{m}{m+1}}.$$

\end{document}
