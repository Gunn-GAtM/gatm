\documentclass[../textbook.tex]{subfiles}

\begin{document}

\section{Composition of Functions}

In this investigation, we will be \textbf{iterating} functions of the form $f(x)=\frac{B}{D-x}$. In other words, we will be composing them with themselves. We will start by doing some numerical experimentation, which will give us an idea of how the iteration works. We will do some algebra composing these functions and note how they form groups, which are isomorphic to some of the symmetry groups we've investigated. Then, we will see how these functions represent geometric transformations, which can in turn be composed and decomposed. Finally, we will find sets of matrices that behave in the same way under multiplication as these functions do under composition. By the time our investigation is through, we should have reviewed many of the themes that we became acquainted with in this book!

Some review: $f^n(x)$ means iterating $f$ on itself $n$ times, or $\underbrace{f(f(\cdots f}_{n\text{ times}}(x)\cdots ))$. $\circ$ means to compose functions. For example, $f\circ f\circ f = f^3$.

To begin with, let's look at the function $f(x)=\frac{1}{1-x}$. We will want to find $f(f(x))=f^2(x)$, $f^3(x)$, etc. Rather than doing the algebra, let's just plug in $x=5$. To do this efficiently:

\begin{enumerate}
\item Enter the number $5$ into your calculator.
\item On the next line, type $1/(1-\text{Ans}).$
\item Hit the enter key a few times; you will find that $f(5)=-.25$, $f^2(5)=.8$, $f^3(5)=5$, etc.
\setcounter{problem_i}{\value{enumi}}
\end{enumerate}

\noindent Clearly, this function has a period of $3$ when the initial value is $5$.
\begin{enumerate}
\setcounter{enumi}{\value{problem_i}}
\item Try a few other values for $x$ to see if and how the periodicity of $f$ depends on $x$.
\item Look at your results of iterating the following functions, and make a table of your results. If the initial value has a problem, record that.

\begin{figure}[h]
	\begin{center}
		\begin{minipage}[b]{\textwidth}
			\centering
			\renewcommand*{\arraystretch}{1.25}
			\begin{tabular}{l|llllllllll}
				\hline
				& $\frac{1}{1-x}$ & $\frac{2}{2-x}$ & $\frac{3}{3-x}$ & $\frac{4}{4-x}$ & $\frac{5}{5-x}$ & $\frac{7}{7-x}$ & $\frac{6}{1-x}$ & $\frac{6}{2-x}$ & $\frac{6}{3-x}$ & $\frac{9}{3-x}$ \\
				\rowcolor{light-gray}
				init.    & $5$   & $5$   & $5$ & $5$ & $5$ & $5$ & $5$ & $5$ & $5$ & $5$ \\
				$f(x)$   & $-.25$&       &   &   &   &   &   &   &   &   \\
				\rowcolor{light-gray}
				$f^2(x)$ & $.8$  &       &   &   &   &   &   &   &   &   \\
				$f^3(x)$ & $5$   &       &   &   &   &   &   &   &   &   \\
				\rowcolor{light-gray}
				$f^4(x)$ & $-.25$&       &   &   &   &   &   &   &   &   \\
				$f^5(x)$ & $.8$  &       &   &   &   &   &   &   &   &   \\
				\rowcolor{light-gray}
				$f^6(x)$ & $5$   &       &   &   &   &   &   &   &   &   \\
				$f^7(x)$ & $-.25$&       &   &   &   &   &   &   &   &   \\
				\rowcolor{light-gray}
				$f^8(x)$ &       &       &   &   &   &   &   &   &   &   \\ \hline
			\end{tabular}
			\vspace*{0.5\baselineskip}
		\end{minipage}
	\end{center}
	\vspace*{-2\baselineskip}
\end{figure}

\item \begin{enumerate}
\item At this point, you should have noticed some fundamentally different types of behavior of $f(x)=\frac{B}{D-x}$ under iteration, depending on the values of $B$ and $D$. What are they?
\item Do you have any theories yet as to when to expect each type of behavior for given values of $B$ and $D$?
\end{enumerate}
\setcounter{problem_i}{\value{enumi}}
\end{enumerate}

\noindent We'll try a slightly more algebraic approach to the problem. Composing $f(x)=\frac{1}{1-x}$ with itself yields:
\begin{align*}
f^2(x)&=\frac{1}{1-\frac{1}{1-x}}=\frac{1-x}{1-x-1}=\frac{x-1}{x} \\
f^3(x)&=\frac{1}{1-\frac{x-1}{x}}=\frac{x}{x-(x-1)}=x.
\end{align*}

\noindent Let's tabulate these results as a group next to the rotation group of the equilateral triangle. Indeed, they are the same, as shown in Figure~\ref{fig:vs_cyclic_3}. Note that $r$ is a rotation of $120^\circ$.

\begin{figure}[h]
	\begin{center}
%\renewcommand*{\arraystretch}{1.25}
		\begin{minipage}[b]{\textwidth}
			\centering
			\begin{tabular}{l|lll||l|lll}
				\hline
				$\circ$  & $x$   & $f$   & $f^2$ & $\cdot$ & $I$   & $r$   & $r^2$ \\ \hline
				\rowcolor{light-gray}
				$x$   & $x$   & $f$   & $f^2$ & $I$   & $I$   & $r$   & $r^2$ \\
				$x$   & $f$   & $f^2$ & $x$   & $r$   & $r$   & $r^2$ & $I$   \\
				\rowcolor{light-gray}
				$f^2$ & $f^2$ & $x$   & $f$   & $r^2$ & $r^2$ & $I$   & $r$   \\ \hline
			\end{tabular}
			\vspace*{0.5\baselineskip}
		\end{minipage}
	\end{center}
	\vspace*{-2\baselineskip}
	\begin{center}
		\begin{minipage}[t]{\textwidth}
			\caption{The group generated by $f(x)=\frac{1}{1-x}$, next to $C_3$.}
			\label{fig:vs_cyclic_3}
		\end{minipage}
	\end{center}
	\vspace*{-2\baselineskip}
\end{figure}

For Problems~\ref{prob:compose_start}--\ref{prob:compose_end},
\begin{enumerate}[label=\roman*.]
\item compose each until $x$ is reached;
\item record each of the functions generated;
\item produce a group table;
\item identify a symmetry group to which each group is isomorphic.
\end{enumerate}

\begin{enumerate}
\begin{multicols}{3}
\setcounter{enumi}{\value{problem_i}}
\item \label{prob:compose_start}$f(x)=\frac{2}{2-x}$
\item $f(x)=\frac{3}{3-x}$
\item \label{prob:compose_end}$f(x)=\frac{9}{3-x}$
\setcounter{problem_i}{\value{enumi}}
\end{multicols}
\end{enumerate}
\begin{enumerate}
\setcounter{enumi}{\value{problem_i}}
\item The function $f(x)=\frac{1}{2-x}$ behaves differently under composition.
\begin{enumerate}
\item Make a record of the first few compositions of $f(x)$ with itself.
\item Write a formula for $f^n(x)$.
\item Write a formula for its inverse function, $f^{-1}(x)$.
\item Why is $f^{-1}\circ f^{-1}=f^{-2}$?
\item What is $f^{-2}\circ f^2$?
\item Taken together, $f(x)$ and $f^{-1}(x)$ generate a group under composition. How big is it?
\item Substitute a value for $x$ and iterate. What happens?
\end{enumerate}
\item The function $f(x)=\frac{2}{1-x}$ illustrates another behavior under composition.
\begin{enumerate}
\item Plug in a value for $x$ and use your calculator to see what happens.
\item Find the inverse of this function.
\item The original function and its inverse once again generate a group under composition. How big is this group?
\item Is it isomorphic to the group in Problem 7?
\item If you have time, write out a few of the elements of the group. Do you see any pattern?
\end{enumerate}
\item Looking back at your results to Problems 4--7, you will notice that the elements of each group are not all in the original form $f(x)=\frac{B}{D-x}$. All, however, are in the form $f(x)=\frac{Ax+B}{Cx+D}$. If $f(x)=\frac{Ax+B}{Cx+D}$ for some $A,B,C,D$, can you always write $f^n$ in the form $f^n(x)=\frac{Px+Q}{Rx+S}$ for some $P,Q,R,S$?
\setcounter{problem_i}{\value{enumi}}
\end{enumerate}

\noindent We will temporarily narrow our focus to the class of functions $f(x)=\frac{1}{D-x}$. We will use algebra to see how $D$ affects the periodicity of $f$.

First, we solve for $D$ when $f$ has period $1$:
\begin{align*}
f(x)=\frac{1}{D-x}&=x \\
D&=\frac{x^2+1}{x}.
\end{align*}

\noindent So there is no constant value of $D$ which gives $f$ a period of $1$. We'll try out periods $2$ and $4$ later, but let's see $3$ and $5$ first. We set $f^3(x)=x$ and proceed:

\allowdisplaybreaks
\begin{align*}
f^3(x)=f(f(f(x)))&=f\left(f\left(\frac{1}{D-x}\right)\right) \\
&= f\left(\frac{1}{D-\frac{1}{D-x}}\right) \\
&= f\left(\frac{D-x}{D^2-Dx-1}\right) \\
&= \frac{1}{D-\frac{D-x}{D^2-Dx-1}} = x \\
\Longrightarrow D^2-Dx-1&=D^3x-D^2x^2-2Dx+x^2 \\
\Longrightarrow D^3x-D^2(x^2+1)-Dx+(x^2+1)&=0 \\
\Longrightarrow (D^2-1)(Dx-(x^2+1))&=0.
\end{align*}

\noindent Setting $D^2-1=0\rightarrow D=\pm 1$ produces a function with period $3$. That is, $f(x)=\frac{1}{1-x}$ and $f(x)=\frac{1}{-1-x}$ have period $3$ under composition. You should recognize one of these already.

Looking at period $5$, we set $f^5(x)=x$. Some nasty algebra is omitted.

\begin{align*}
f^5(x)=f(f(f^3(x)))&=f\left(f\left(\frac{1}{D-\frac{D-x}{D^2-Dx-1}}\right)\right) \\
&=\frac{D^4-D^3x-3D^2+2Dx+1}{D^5-D^4x-4D^3+3D^2x+3D-x}=x \\
\Longrightarrow (Dx-(x^2+1))(D^4-3D^2+1)&=0 \\
\Longrightarrow D^2&=\frac{3\pm\sqrt{5}}{2} \\
\Longrightarrow D &= \pm{\sqrt{\frac{3\pm\sqrt{5}}{2}}}
\end{align*}

\noindent So we have that $f(x)=\frac{1}{\pm\sqrt{\frac{3\pm\sqrt{5}}{2}}-x}$ for period $5$.

This algebra is getting annoying, but matrices can simplify the process. In particular, we can make a correspondence between the functions generated by composing functions of the form $f(x)=\frac{Ax+B}{Cx+D}$ and the matrices generated by multiplying matrices of the form $F=\twomat{A}{B}{C}{D}$.

\begin{enumerate}
\setcounter{enumi}{\value{problem_i}}
\item \begin{enumerate}
\item Let $f(x)=\frac{Ax+B}{Cx+D}$, $g(x)=\frac{Px+Q}{Rx+S}$, and $h(x)=\frac{Tx+U}{Vx+W}$. Show that if $f\circ g = h$, then
$$\twomat{A}{B}{C}{D}\twomat{P}{Q}{R}{S}=\twomat{T}{U}{V}{W}.$$
Do this by computing $f(g(x))$ and the matrix product, then comparing.
\item This is not a true one-to-one correspondence. Why not? (Hint: think about when division is undefined, as compared to matrix multiplication.)
\end{enumerate}
\setcounter{problem_i}{\value{enumi}}
\end{enumerate}

\noindent We will now use this ``isomorphism'' to make the job of composing functions easier. If $f(x)=\frac{1}{D-x}$, then $F=\left[\begin{array}{cc} 0 & 1 \\ -1 & D \end{array}\right]$ corresponds to $f$.

\begin{align*}
F^2 &= \twomat{0}{1}{-1}{D}\twomat{0}{1}{-1}{D} \\
&= \twomat{-1}{D}{-D}{D^2-1} \\
\Longrightarrow \Aboxed{f^2(x) &= \frac{D-x}{D^2-Dx-1}} \\
F^3 = FF^2 &= \twomat{0}{1}{-1}{D}\twomat{-1}{D}{-D}{D^2-1} \\
&= \twomat{-D}{D^2-1}{1-D^2}{D^3-3D} \\
\Longrightarrow \Aboxed{f^3(x) &= \frac{(D^2-1)-Dx}{(1-D^2)x+(D^3-2D)}}
\end{align*}

\begin{enumerate}
\setcounter{enumi}{\value{problem_i}}
\item Find $f^4(x)$, $f^5(x)$, and $f^6(x)$ using matrices.
\setcounter{problem_i}{\value{enumi}}
\end{enumerate}

\noindent Recall that to find what values of $D$ result in period $n$, we solve $f^n(x)=x$. Now, you can get to solve for values of $D$, which will produce periods of two, four, and six. Some things to consider:

\begin{itemize}
\item We had no solutions for period one, two solutions for period three, and four solutions for period five. How many do you expect for periods two, four, and six?
\item If a function repeats itself every two iterations, will it necessarily repeat itself every four iterations? Every six iterations?
\item Given the previous question, what do we know about some of the solutions for $D$ for periods four and six, as compared with the true periods?
\end{itemize}
\begin{enumerate}
\setcounter{enumi}{\value{problem_i}}
\item Use algebra or a computer algebra system---if you're lazy---to solve the following equations for $D$. Use $f^2$ from my writing above; use $f^4$ and $f^6$ from your answers to Problem 11.
\begin{enumerate}
\begin{multicols}{3}
\item $f^2(x)=x$
\item $f^4(x)=x$
\item $f^6(x)=x$
\end{multicols}
\end{enumerate}
\item For each period, choose one of your solutions for $D$, then use your calculator to iterate $f(x)=\frac{1}{D-x}$.
\begin{enumerate}
\begin{multicols}{3}
\item Period 2: $$D=\underline{\phantom{egg}}$$ $$f(x)=\underline{\phantom{egg}}$$ $$\text{Found period}=\underline{\phantom{egg}}$$
\item Period 4: $$D=\underline{\phantom{egg}}$$ $$f(x)=\underline{\phantom{egg}}$$ $$\text{Found period}=\underline{\phantom{egg}}$$
\item Period 6: $$D=\underline{\phantom{egg}}$$ $$f(x)=\underline{\phantom{egg}}$$ $$\text{Found period}=\underline{\phantom{egg}}$$
\end{multicols}
\end{enumerate}
\setcounter{problem_i}{\value{enumi}}
\end{enumerate}

\noindent Now, we turn our attention to fixed points. These are points where $f(x)=x$. We already discovered that there is no constant $D$ such that $\frac{1}{D-x}=x$ for \textit{all} $x$, but it is true for \textit{some} $x$. In particular, you can solve the equation to find $x=\frac{D\pm \sqrt{D^2-4}}{2}$. Use this fact in the following problem:

\begin{enumerate}
\setcounter{enumi}{\value{problem_i}}
\item \begin{enumerate}
\item For what values of $D$ is $x$ real?
\item For what values does $x$ have a nonzero imaginary component?
\item What is true of the fixed points for all of the cases where $f(x)$ is periodic?
\end{enumerate}
\setcounter{problem_i}{\value{enumi}}
\end{enumerate}

\noindent It looks like the natural home of the function $f(x)=\frac{1}{D-x}$ is actually in the complex plane. Let's rename it to $f(z)=\frac{1}{D-z}$, since we're dealing with complex numbers now. Thus, $z=\frac{D\pm \sqrt{D^2-4}}{2}$. We'll continue to say that $D$ is real, though.

\begin{enumerate}
\setcounter{enumi}{\value{problem_i}}
\item \begin{enumerate}
\item Plot a graph in the complex plane of all the fixed points as $D$ ranges over the real numbers. Your graph should be a circle and two rays.
\item Plot and label the fixed points associated with $D$ values for periods $2,3,4,5$. What do you notice?
\item Make a prediction about the values of the fixed points associated with functions of period $7$ and $8$.
\item Then predict what values of $D$ will produce periods of $7$ and $8$ for $f(z)=\frac{1}{D-z}$ under iteration.
\item Use your calculator to iterate your functions for $7,8$ and confirm your hypothesis.
\item Use your calculator to show that the fixed points for $7,8$ remains fixed.
\item Where do you suppose you would locate the fixed point so that you had an ``infinite'' period?
\item Construct an example of $f(z)=\frac{1}{D-z}$ with $|D|<2$ and an infinite period.
\item Once again, check using your calculator.
\end{enumerate}
\item \begin{enumerate}
\item Find the fixed points for:
\begin{enumerate}
\begin{multicols}{3}
\item $f(z)=\frac{1}{2-z}$
\item $f(z)=\frac{1}{3-z}$
\item $f(z)=\frac{1}{4-z}$
\end{multicols}
\end{enumerate}
\item Use your calculator to iterate these functions using a variety of initial values.
\item What do you notice about these functions?
\end{enumerate}
\setcounter{problem_i}{\value{enumi}}
\end{enumerate}

\noindent By this time, you should have a good sense of the behavior of $f(z)=\frac{1}{D-z}$ under iteration. You should know how to select the value of $D$ so that the function approaches a fixed point, has a finite period of $n$, or neither. The reasoning behind why this is, however, is likely still unclear.

To begin to answer these questions, we will investigate our function from a geometric, rather than algebraic, point of view. Until this point, we have been composing our function. Decomposing it, however, will shed more light on the subject.

We willl begin by decomposing $f(z)=\frac{1}{1-z}$. In doing so, we must find two functions $g(z)$ and $h(z)$ with $g(h(z))=f(z)$. The most obvious way to do this is to let $g(z)=\frac{1}{z}$ and $h(z)=1-z$, but this will result in some obscure geometry.

The more useful way to decompose it is to let $g(z)=\frac{1}{\overline{z}}$ and $h(z)=\overline{1-z}$.\footnote{Remember that $\overline{z}$ is the complex conjugate.} If $z=a+bi$ for real $a$ and $b$, then by definition, $\overline{z}=a-bi$. So we have
$$g(h(z))=g(\overline{1-z})=\overline{\left(\frac{1}{\overline{1-z}}\right)}=\frac{1}{1-z}=f(z).$$

\begin{enumerate}
\setcounter{enumi}{\value{problem_i}}
\item Let's look at the geometry of $g$ and $h$ by completing the table in Figure~\ref{fig:z_values}. After doing this, you should be able to characterize how $g(z)$ and $h(z)$ transform the complex plane.
\item Find the set of points which remain fixed under $h(z)$.
\begin{enumerate}
\item What is an equation for it?
\item Give it a geometric name. It will help to complete the table first.
\end{enumerate}
\item Find the set of points which remain fixed under $g(z)$.
\begin{enumerate}
\item What is an equation for it?
\item Give it a geometric name.
\end{enumerate}
\item There are two points which remain fixed under both $g(z)$ and $h(z)$.
\begin{enumerate}
\item What are they?
\item Would they remain fixed under $g(h(z))$? Why or why not?
\end{enumerate}
\item What transformation of the plane does $h(z)$ produce?
\item What transformation of the plane does $g(z)$ produce?
\setcounter{problem_i}{\value{enumi}}
\end{enumerate}

\noindent The transformation produced by $h(z)$ is a reflection over the line $x=.5$. The transformation produced by $g(z)$ is called an \textbf{inversion} over the unit circle. It is similar to a reflection, and if the preimage is very close to the unit circle the image is almost identical to the reflection of the preimage over the circle's circumference. The two transformations are depicted for various points in Figures~\ref{fig:function_h} and \ref{fig:function_g}.

\begin{enumerate}
\setcounter{enumi}{\value{problem_i}}
\item Recall that successive reflections over two intersecting lines produce a rotation around the point of intersection, by twice the angle between the two lines.
\begin{enumerate}
\item What is the angle between the unit circle and the line $x=.5$ at the point of intersection?
\item If you chose your initial value of $x$ to be ``close to'' one of the fixed points, what would you expect to happen if you transform it with $g(h(z))$...
\begin{enumerate}
\begin{multicols}{3}
\item ... once?
\item ... twice?
\item ... thrice?
\end{multicols}
\end{enumerate}
\end{enumerate}
\item \begin{enumerate}
\item Use your calculator to test your hypothesis by picking a point close to $.5(1+\sqrt{3})$, like $.5+.85i$, as an initial value. Then, iterate $f(x)=\frac{1}{1-z}$.
\item What happens as you move your initial value farther from the fixed point?
\end{enumerate}
\setcounter{problem_i}{\value{enumi}}
\end{enumerate}

\begin{figure}[h]
	\begin{center}
		\begin{minipage}[b]{0.45\textwidth}
			\centering
			\renewcommand{\arraystretch}{1.25}
			\begin{tabular}{l|l||l|l}
				\hline
				$z$ & $h(z)=\overline{1-z}$ & $z$  & $g(z)=\frac{1}{\overline{z}}$ \\ \hline
				\rowcolor{light-gray}
				$i$ & $1+i$   & $i$  & $i$ \\
				$0$ & & $0$  & \\
				\rowcolor{light-gray}
				$.5$& & $.5$ & \\
				$2$ & & $2$  & \\
				\rowcolor{light-gray}
				$3$ & & $3$  & \\
				$-1$& & $-1$ & \\
				\rowcolor{light-gray}
				$-2$& & $-2$ & \\
				$-3$& & $-3$ & \\
				\rowcolor{light-gray}
				$2i$& & $2i$ & \\
				$3i$& & $3i$ & \\
				\rowcolor{light-gray}
				$-i$& & $-i$ & \\
				$1+i$ & & $1+i$& \\
				\rowcolor{light-gray}
				$.5+i$& & $.5+i$     & \\
				$.5+2i$     & & $.5(1+i)$  & \\
				\rowcolor{light-gray}
				$.5-i$& & $.5(-1+i\sqrt{3})$ & \\
				$-.5+i$     & & $.5(-1-i\sqrt{3})$ & \\
				\rowcolor{light-gray}
				$.5(1+i\sqrt{3})$ & & $.5(1+i\sqrt{3})$  & \\
				  & & $.5(1-\sqrt{3})$   & \\
				  \rowcolor{light-gray}
				  & & $.5(i+\sqrt{3})$   & \\
				  & & $.5(\sqrt{2}+i\sqrt{2})$ & \\ \hline
			\end{tabular}
			\vspace*{0.5\baselineskip}
		\end{minipage}
		\hfill
		\begin{minipage}[b]{0.45\textwidth}
			\begin{center}
				\begin{minipage}[b]{\textwidth}
					\centering
					\begin{asy}[width=0.7\textwidth]
						draw((-2,0)--(2,0),Arrow);
						draw((0,-2)--(0,2),Arrow);

						draw((-2,.5)--(2,.5),dashed);

						pair P = (1,1);
						pair Q = (.5,1);
						pair R = -.5 * (1,sqrt(3));
						pair S = .5 * (sqrt(2), sqrt(2)-.1);
						label("$\operatorname{Im}(z)=\frac{1}{2}$", (-2,.5),NE);

						pair transform(pair p) {
							return (p.x, 1 - p.y);
						}

						pair[] pair_list = {P,Q,R,S};
						string[] labels={"P","Q","R","S"};

						for (int i = 0; i < 4; ++i) {
							pair pairc = pair_list[i];
							pair pairtr = transform(pairc);
							draw(pairc--pairtr, dashed);
							dot(pairtr);
							dot(pairc);

							label("$" + labels[i] + "$", pairc, (i!=2) ? N : (0,-1));
							label("$" + labels[i] + "'$", pairtr, (i!=2) ? (0,-1) : N);
						}
					\end{asy}
				\end{minipage}
			\end{center}
			\vspace*{-2\baselineskip}
			\begin{center}
				\begin{minipage}[t]{\textwidth}
					\caption{The transformation $h(z)=\overline{1-z}$.}
					\label{fig:function_h}
				\end{minipage}
			\end{center}

			\begin{center}
				\begin{minipage}[b]{\textwidth}
					\centering
					\begin{asy}[width=0.7\textwidth]
						draw((-2,0)--(2,0),Arrow);
						draw((0,-2)--(0,2),Arrow);

						draw((1,0)..(0,1)..(-1,0)..(0,-1)..cycle);

						pair P = (-1,1);
						pair Q = 1.7*(.5,1);
						pair R = -.9 * (1,sqrt(3));
						pair S = .5 * (sqrt(2), sqrt(2));

						pair transform(pair p) {
							return (p.x, p.y) * 1 / (p.x*p.x+p.y*p.y);
						}

						pair[] pair_list = {P,Q,R,S};
						string[] labels={"P","Q","R","S"};
						pair[] dirs={NW,SE,N,SE,(0,-1),NW};

						for (int i = 0; i < 3; ++i) {
							pair pairc = pair_list[i];
							pair pairtr = transform(pairc);
							draw(pairc--pairtr, dashed);
							dot(pairtr);
							dot(pairc);

							label("$" + labels[i] + "$", pairc, dirs[2*i]);
							label("$" + labels[i] + "'$", pairtr, dirs[2*i+1]);
						}

						dot(S);
						label("$S=S'$", S, NE);
						label("$|z|=1$", (cos(-pi/4), sin(-pi/4)), SE);
					\end{asy}
				\end{minipage}
			\end{center}
		\end{minipage}
	\end{center}
	\vspace*{-2\baselineskip}
	\begin{center}
		\begin{minipage}[t]{0.45\textwidth}
			\caption{Some values to try for $z$ for $g$ and $h$.}
			\label{fig:z_values}
		\end{minipage}
		\hfill
		\begin{minipage}[t]{0.45\textwidth}
			\caption{The transformation $g(z)=\frac{1}{\overline{z}}$.}
			\label{fig:function_g}
		\end{minipage}
	\end{center}
	\vspace*{-2\baselineskip}
\end{figure}

\begin{enumerate}
\setcounter{enumi}{\value{problem_i}}


\item It appears that this composition of functions produces a rotation-like transformation, but there are two ``competing'' centers with the nearer center to a point ``exerting more influence.'' The ``rotation'' is distorted more and more the farther you are from the fixed points. What happens when the initial value is on the real axis?
\item What is the period of
\begin{enumerate}
\begin{multicols}{2}
\item $g(z)=\frac{1}{\overline{z}}$?
\item $h(z)=\overline{1-z}$?
\end{multicols}
\end{enumerate}
\setcounter{problem_i}{\value{enumi}}
\end{enumerate}

\noindent We will now return to our original idea for decomposing $f(z)=\frac{1}{1-z}$ as $g(z)=\frac{1}{z}$ and $h(z)=1-z$. We will take an algebraic point of view, so it makes it easier to not use conjugation.

\begin{enumerate}
\setcounter{enumi}{\value{problem_i}}
\item We will compose $g(z)=\frac{1}{z}$ and $h(z)=1-z$. Feel free to use a computer algebra system to do these problems.
\begin{enumerate}
\begin{multicols}{3}
\item $g\circ g$
\item $h\circ h$
\item $g\circ h$
\item $g\circ g\circ h$
\item $g\circ h\circ h$
\item $g\circ g\circ h$
\item $g\circ h\circ g$
\item $g\circ h\circ g\circ h$
\item $g\circ h\circ g\circ h\circ g$
\item $g\circ h\circ g\circ h\circ g\circ h$
\item $h\circ g$
\item $h\circ g\circ h$
\item $h\circ g\circ h\circ g$
\item $h\circ g\circ h\circ g\circ h$
\item $h\circ g\circ h\circ g\circ h\circ g$
\end{multicols}
\end{enumerate}
\item Let $j(z)=g\circ h\circ g(z)$ and let $k(z)=g\circ h\circ g\circ h(z)=f^2(z)$. Also, let $I(z)=z$ be the identity function. In the group table, let the function on the top be in the inner function, and the function on the left be the outer function, so for example $g\circ h(z)=f(z)$ as shown.
\begin{figure}[h]
	\begin{center}
		\begin{minipage}[c]{0.55\textwidth}
			\begin{enumerate}
				\item Complete the group table.
				\item Is this group commutative?
				\item What group(s) is it isomorphic to?
				\item What subgroup(s) does it have?
			\end{enumerate}
		\end{minipage}
		\hfill
		\begin{minipage}[c]{0.35\textwidth}
			\begin{center}
				\begin{minipage}[b]{\textwidth}
					\centering
					\begin{tabular}{c|cccccc}
						\hline
						$\circ$ & $I$ & $f$ & $k$ & $g$ & $j$ & $h$ \\ \hline
						\rowcolor{light-gray}
						$I$ & & & & & & \\
						$f$ & & & & & & \\
						\rowcolor{light-gray}
						$k$ & & & & & & \\
						$g$ & & & & & & $f$\\
						\rowcolor{light-gray}
						$j$ & & & & & & \\
						$h$ & & & & & & \\ \hline
					\end{tabular}
				\end{minipage}
			\end{center}
		\end{minipage}
	\end{center}
	\vspace*{-2\baselineskip}
\end{figure}
\item Repeat the above analysis on the function (i) $f(z)=-\frac{1}{z}$, (ii) $f(z)=\frac{1}{\sqrt{2}-z}$, and (iii) $f(z)=\frac{1}{\sqrt{3}-z}$.
\begin{enumerate}
\item Decompose it into two functions involving complex conjugates and graph the fixed points of each function.
\item Find the intersection of the two sets of fixed points.
\item Describe what each of the functions does.
\item Decompose the function into two functions that do not involve conjugates and recompose them.
\item Make a group table.
\item What groups is this group isomorphic to?
\end{enumerate}
\item Now, consider the function $f(z)=\frac{1}{2-z}$.
\begin{enumerate}
\item Decompose it into two functions involving complex conjugates and graph the fixed points of each function.
\item Where do they intersect?
\item Use your graph to visualize what happens when you take a point, reflect it over the line, and invert it about the circle.
\item Iterate this process---don't use your calculator for now. Where do you end up?
\item Use your calculator to confirm your prediction, keeping track of where you end up on the graph after each iteration.
\item Use a variety of initial points, and don't only use real ones.
\end{enumerate}
\item Repeat the process of the previous problem for the functions $f(z)=\frac{1}{3-z}$ and $f(z)=\frac{1}{4-z}$.
\begin{enumerate}
\item Decompose them using conjugates, and graph the set of fixed points.
\item Note that although the circle of inversion and reflection line do not intersect, $f(x)$ still has two fixed points. Find them algebraically.
\item Note that the two fixed points play a fundamentally different role. one is called an attractive fixed point, while the other is a repelling fixed point. Why?
\item Was this the case for $D$ values which produced non-real fixed points?
\item How does iterating functions like $f(z)=\frac{1}{3-z}$ compare to repeated, sequential reflection over two parallel lines?
\end{enumerate}
\setcounter{problem_i}{\value{enumi}}
\end{enumerate}

\noindent By now, you should have a good geometric sense of what causes the function $f(x)=\frac{1}{D-x}$ to oscillate when $|D|<2$, to be periodic with a period of $n$ when $|D|<2$ and $D=2\cos \frac{k\pi}{n}$ for integers $k,n$, and to approach a fixed point when $|D|\geq 2$.

We would still like to make sure that our \textit{geometric} insights are \textit{algebraically} correct. To do that, we will take another look at the correspondence


$$f(x)=\frac{Ax+B}{Cx+D}\Longleftrightarrow F=\twomat{A}{B}{C}{D}.$$

\noindent Consider the matrix $\twomat{0}{1}{-1}{D}$. Under multiplication, it will be periodic with period $n$ if and only if

$$\twomat{0}{1}{-1}{D}^n=\twomat{1}{0}{0}{1}.$$

\noindent Recall that when a matrix $M$ acts on a vector $v$, it usually changes its directions, but that if it has independent eigenvectors $v_1$ and $v_2$, they will act as though they are being multiplied by a scalar constant. That is, $Mv_1=\lambda_1 v_1$ and $Mv_2=\lambda_2 v_2$ for some complex $\lambda_1,\lambda_2$. Also, recall that any vector in the plane can be decomposed as $v=av_1+bv_2$. Because $M$ is periodic, $M^nv_1=Iv_1$, but $M^nv_1=\lambda_1^n v_1$, so we need to find which values of $D$ produces eigenvalues where $\lambda_1^n=1$: the roots of unity.

\begin{enumerate}
\setcounter{enumi}{\value{problem_i}}
\item Solve the eigenvalues $\lambda_1$ and $\lambda_2$ of $\twomat{0}{1}{-1}{D}$. In the course of doing so, you should come across an equation which reminds you of the formula for fixed points.
\item For what values of $D$ do the eigenvalues have magnitudes of $1$? For what values of $D$ are they $n$\textsuperscript{th} roots of unity? Express your answer as a trig function of $n$.
\item Let $D=1$, so $F=\twomat{0}{1}{-1}{1}$.
\begin{enumerate}
\item What are the eigenvalues of $F$? Express them in terms of $\operatorname{cis} \theta$.
\item What is the period of this matrix under multiplication with itself?
\item Explain the apparent discrepancy between the period of this matrix under multiplication with itself and that of $f(z)=\frac{1}{1-z}$ under iteration.
\end{enumerate}
\item Look at your answers to $f(z)=\frac{2}{2-z}$ and $f(z)=\frac{3}{3-z}$ from the first table in this chapter.
\begin{enumerate}
\item What were their periods?
\item What is the circle of inversion for each one?
\item Write the matrices which correspond to $f(z)=\frac{2}{2-z}$ and $f(z)=\frac{3}{3-z}$.
\item Are the determinants of these matrices $1$?
\item Will these matrices ever repeat themselves under successive multiplication?
\item Find the eigenvalues of these matrices.
\item Are the eigenvalues' magnitudes $1$?
\end{enumerate}
\end{enumerate}
\end{document}

% well, that's the end of this massive text. I would have thought there would be something of a more poetic ending than just a problem set that unceremoniously closes off this book. I guess we can't have everything though.
