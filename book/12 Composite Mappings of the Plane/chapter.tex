\documentclass[../textbook.tex]{subfiles}

\begin{document}

\section{Composite Mappings of the Plane}
\setcounter{problem_i}{0}
\newcounter{bruh_count}

So far, we have identified matrices that result in some specific mappings of the plane, including rotations, reflections, etc. We have seen how matrices interact with each other in the context of groups. Now, let's see what happens when we combine two mappings of the plane. For example, let's see what a rotation of $-90^\circ$ about the origin, followed by a reflection across the $x$ axis, does to our unit vectors $(1,0)$ and $(0,1)$. Then, let's extend this to the point $(u,v)$.

\newcommand{\blanktwomat}{\twomat{\phantom{0}}{\phantom{0}}{}{}}

\begin{enumerate}
\item For Problems~\ref{prob:cm_fill_in_blank_start} through~\ref{prob:cm_fill_in_blank_end}, fill in the blank.
\begin{enumerate}
\item We start by finding the images of our points under the $-90^\circ$ rotation. \label{prob:cm_fill_in_blank_start}
\begin{enumerate}
\item Find the matrix $R$ which results in a $-90^\circ$ rotation.
\item  \label{prob:intermediate_result_matrix} Multiply $R$ by our unit vectors and point $(u,v)$: $$\blanktwomat\left[\begin{array}{ccc} 1 & 0 & u \\ 0 & 1 & v \end{array}\right] = \left[\phantom{\begin{array}{ccc} 1 & 0 & u \\ 0 & 1 & v \end{array}}\right]$$
\end{enumerate}
\item Next, we reflect those intermediate image points over the line $y=0$.
\begin{enumerate}
\item Find the matrix $S$ which does this.
\item Multiply $S$ by the result of Problem~\ref{prob:intermediate_result_matrix}.
\end{enumerate}
\item You should notice that the net result of the two transformations taken together is a reflection over the line $y=x$. Which matrix represents this transformation?
\item Notice that what we did to achieve this mapping was $$\twomat{1}{0}{0}{-1}\twomat{0}{1}{-1}{0}\left[\begin{array}{ccc} 1 & 0 & u \\ 0 & 1 & v \end{array}\right]=\left[\phantom{\begin{array}{ccc} 1 & 0 & u \\ 0 & 1 & v \end{array}}\right],$$
where we multiplied the two rightmost matrices first but didn't use the associative property to multiply the two leftmost matrices first. See what happens when you multiply the two left hand matrices together: $$\twomat{1}{0}{0}{-1}\twomat{0}{1}{-1}{0}=\blanktwomat.$$ Look familiar?
\item See what happens when you reverse the order of multiplication: \label{prob:cm_fill_in_blank_end}
$$\twomat{0}{1}{-1}{0}\twomat{1}{0}{0}{-1}=\blanktwomat$$
\item \begin{enumerate}
\item What transformation does this new matrix result in?
\item How is a reflection followed by a rotation different from a rotation followed by a reflection? Visualize this by following what happens to a point under both sets of transformations.
\end{enumerate}
\item Notice that we apply the transformations from right to left. If you wanted to read from left to right, what would you have to change about the way you wrote the mapping matrices, the vectors representing points, and the order of the matrices?
\item How does our convention for ordering transformation matrices compare...
\begin{enumerate}
\item ... to the convention for writing composite functions, like $f(g(x))$?
\item ... to the ``followed by'' convention we used for ``From Snaps to Flips?''
\item ... to the ``from \underline{\phantom{egg}} to \underline{\phantom{egg}}'' convention for transportation matrices?
\end{enumerate}
\end{enumerate}
\item There are two, infinite classes of matrices which comprise all isometries of the plane which keep the origin fixed. These are the rotation matrix and reflection matrix. Let's look first at the rotation matrix and make sure that it really always works the way it should.
\begin{enumerate}
\item What is the result of a rotation by an angle $\theta$ followed by one of $\phi$?
\item Multiply their rotation matrices: $\twomat{\cos \phi}{-\sin \phi}{\sin\phi}{\cos\phi} \twomat{\cos \theta}{-\sin \theta}{\sin\theta}{\cos\theta}=\blanktwomat$
\item Use the angle addition formulae to simplify your answer.
\item Should the result be the same if you reverse the order of rotation?
\item What happens to the points $(1,0)$, $(0,1)$, and $(x,y)$ when you operate on them with the rotation matrix? $$\twomat{\cos \theta}{-\sin \theta}{\sin\theta}{\cos\theta}\left[\begin{array}{ccc} 1 & 0 & x \\ 0 & 1 & y \end{array}\right]$$
\end{enumerate}
\item Now let's check for the generalized reflection matrix.
\begin{enumerate}
\item Take the matrix which results in a reflection over the line $y=x\tan \frac{\theta}{2}$ and reflect over that line twice: $$\twomat{\cos\theta}{\sin\theta}{\sin\theta}{-\cos\theta}\twomat{\cos\theta}{\sin\theta}{\sin\theta}{-\cos\theta}.$$
\item Simplify your answer and explain the result.
\item Let's do a reflection over the line $y=x\tan\frac{\theta}{2}$ followed by a reflection over the line $y=x\tan\frac{\phi}{2}$:
$$\twomat{\cos\phi}{\sin\phi}{\sin\phi}{-\cos\phi}\twomat{\cos\theta}{\sin\theta}{\sin\theta}{-\cos\theta}.$$
\item Simplify your answer using the angle addition formulae, and interpret.
\item Does it make a difference which reflection comes first? Do the matrix multiplication to confirm your answer.
\end{enumerate}
\item We've found specific matrices which map the plane in the following ways:
\setcounter{problem_i}{\value{enumi}}
\begin{itemize}
\item identity; %compare-books-disable
\item rotation about the origin by $\theta$; %compare-books-disable
\item reflection over a line $y=x \tan\frac{\theta}{2}$; %compare-books-disable
\item size change by some factor centered at the origin; %compare-books-disable
\item stretching along a specific line through the origin by some factor; %compare-books-disable
\item shearing perpendicular to a specific line through the origin by some factor. %compare-books-disable
\end{itemize}
\setcounter{enumi}{\value{problem_i}}
We want to generalize those ideas. What does each of the following matrices do? Be quantitative by specifying angle, equation of line, and/or factor:\label{prob:list_transformations}
\begin{enumerate}
\begin{multicols}{3}
\item $\twomat{1}{0}{0}{1}$ \label{prob:list_transformations_part_start}
\item $\twomat{a}{0}{0}{a}$
\item $\twomat{\cos\theta}{-\sin\theta}{\sin\theta}{\cos\theta}$
\item $\twomat{\cos\theta}{\sin\theta}{-\sin\theta}{\cos\theta}$
\item $\twomat{a}{0}{0}{1}$
\item $\twomat{1}{0}{0}{a}$
\item $\twomat{1}{a}{0}{1}$
\item $\twomat{1}{0}{a}{1}$
\item $\twomat{a}{b}{ca}{cb}$
\item $\twomat{-1}{0}{0}{1}$ \label{prob:highlighted_example_list_transformations1}
\item $\twomat{0}{-1}{-1}{0}$ \label{prob:highlighted_example_list_transformations2}
\item $\twomat{\cos 2\theta}{\sin 2\theta}{\sin 2\theta}{-\cos 2\theta}$ \label{prob:list_transformations_part_end}
\end{multicols}
\end{enumerate}
\item What matrix/transformation undoes each of \ref{prob:list_transformations_part_start} through \ref{prob:list_transformations_part_end}? For instance, matrix 4c is a rotation of $\theta$. It is undone by a rotation of $-\theta$, which is matrix 4d.
\item In this problem, you will observe the effects of multiplying two or more matrices. Do the following matrix multiplications, graph the preimage $\left[\begin{array}{cc}1 & 0 \\ 0 & 1\end{array}\right]$ and image, then identify the transformations and their order. Note the effect of order on the outcome!
\setcounter{bruh_count}{\value{enumi}}
\end{enumerate}

\noindent But first, an example:
$$\twomat{5}{0}{0}{5}\twomat{.8}{.6}{-.6}{.8}=\twomat{4}{3}{-3}{4}.$$

\noindent This is a rotation of $\tan^{-1}\left(-\frac{3}{4}\right)\approx-36.87^\circ$, followed by a size change by a factor of $5$. Remember to read from right to left. The preimage and image are shown in Figure~\ref{fig:preimage_image_mat}.

% no space, had to split up the fance side by side thing

\begin{figure}[h]
	\begin{center}
		\begin{minipage}[b]{\textwidth}
			\centering
			\begin{asy}[width=0.3\textwidth]
				draw((-2,0)--(9.5,0),Arrow);
				draw((0,-5)--(0,6.5),Arrow);
				
				for (int i = -1; i < 9; ++i) {
					for (int j = -4; j < 6; ++j) {
						dot((i, j), filltype=FillDraw(fillpen=white, drawpen=black));
					}
				}
				filltype fillc =FillDraw(fillpen=black,drawpen=black);
				pen size = 1+currentpen;
				
				dot((0,0), size, fillc);
				dot((1,0), size, fillc);
				dot((0,1), size, fillc);
				
				dot((3,4), size, fillc);
				dot((4,-3), size, fillc);
				
				path rot1=(0,1)..(3,4);
				path rot2=(1,0)..(4,-3);
				
				draw(subpath(rot1,0.1,0.9),Arrow);
				draw(subpath(rot2,0.1,0.9),Arrow);
			\end{asy}
		\end{minipage}
	\end{center}
	\vspace*{-2\baselineskip}
	\begin{center}
		\begin{minipage}[t]{\textwidth}
			\captionof{figure}{The preimage and image.}
			\label{fig:preimage_image_mat}
		\end{minipage}
	\end{center}
	\vspace*{-2\baselineskip}
\end{figure}

\begin{enumerate}
\setcounter{enumi}{\value{bruh_count}}
\item[]
\begin{enumerate}
\begin{multicols}{3}
\item $\twomat{1}{2}{0}{1}\twomat{.6}{-.8}{.8}{.6}$
\item $\twomat{.6}{-.8}{.8}{.6}\twomat{1}{2}{0}{1}$
\item $\twomat{4}{0}{0}{1}\twomat{\frac{\sqrt{3}}{2}}{\frac{1}{2}}{-\frac{1}{2}}{\frac{\sqrt{3}}{2}}$
\item $\twomat{\frac{\sqrt{3}}{2}}{\frac{1}{2}}{-\frac{1}{2}}{\frac{\sqrt{3}}{2}}\twomat{4}{0}{0}{1}$
\item $\twomat{.8}{.6}{-.6}{.8}\twomat{5}{0}{0}{5}$
\item $\twomat{5}{0}{0}{5}\twomat{.8}{.6}{-.6}{.8}$
\item $\twomat{.6}{-.8}{.8}{.6}\twomat{.8}{-.6}{.6}{.8}$
\item $\twomat{.6}{.8}{.8}{-.6}\twomat{.6}{.8}{.8}{-.6}$
\item $\twomat{.6}{.8}{.8}{-.6}\twomat{.8}{.6}{.6}{-.8}$
\end{multicols}
\end{enumerate}
\item A \textbf{linear mapping} $f$ is one in which all lines are mapped to lines and the origin remains a fixed point. Algebraically, $f\left(\left[\begin{array}{c}x \\ y \end{array}\right]\right)=xf\left(\left[\begin{array}{c}1 \\ 0 \end{array}\right]\right)+yf\left(\left[\begin{array}{c}0 \\ 1 \end{array}\right]\right).$ I claim that we can build any linear mapping of the plane by multiplying together some combination of the matrices from Problem~\ref{prob:list_transformations}. Only two classes of matrix, however, are necessary; all other matrices are products or examples of these. Which two classes of matrix do you think comprise the minimum set from which the others can be composed? Be able to justify your choice.
\item Write matrix products that perform the following mappings. Do the indicated multiplication and graph the preimage and image when applied to $(1,0)$ and $(0,1)$.
\begin{enumerate}
\item Rotation by $135^\circ$ followed by a shear by a factor of $\frac{1}{2}$ \textit{perpendicular} to the $y$ axis \label{prob:matrix_prod_start}
\item Same transformations as in (a), but order reversed
\item Stretch in the $y$ direction by a factor of $3$ followed by a rotation of $60^\circ$
\item Same transformations as in (c), but order reversed
\item Projection onto the line $y=5x$
\item Reflection over $\theta=\frac{\pi}{12}$ followed by a stretch in the $x$ direction by a factor of $2$
\item Same transformations as in (f), but order reversed \label{prob:matrix_prod_end}
\end{enumerate}
\item Write a set of matrices which undoes Problems~\ref{prob:matrix_prod_start} through~\ref{prob:matrix_prod_end}. You will find one of them impossible to undo; explain why.
\item \begin{enumerate}
\item Find the height of the parallelogram in Figure~\ref{fig:parallelogram_generic} in terms of $b$ and a trig function in terms of $\varphi$.
\item Find the area of the parallelogram in terms of $a$, $b$, and $\varphi$.
\end{enumerate}
\setcounter{problem_i}{\value{enumi}}
\end{enumerate}

\begin{figure}[h]
	\begin{center}
		\begin{minipage}[b]{0.3\textwidth}
			\centering
			\begin{asy}[width=0.9\textwidth]
				pair A = (0,0);
				pair B = (4,4);
				pair D = (8,0);
				pair C = B+D;
				draw(A--B--C--D--cycle);
				draw(B--(4,0));
				
				label("$\varphi$", A, 2.8*ENE);
				draw(arc((0,0), point(A--D, 0.25), point(A--B,0.25)));
				label("$h$", (4,2),W);
				label("$b$", A--B, NW);
				
				path a_brace = shift(0,-0.2)*brace(D,A);
				draw(a_brace);
				
				draw((4,0.6)--(3.4,0.6)--(3.4,0));
				
				label("$a$", a_brace, S);
			\end{asy}
		\end{minipage}
		\hfill
		\begin{minipage}[b]{0.3\textwidth}
			\centering
			\begin{asy}[width=0.7\textwidth]
				pair A = (0,0);
				pair B = (4,4);
				pair D = (8,0);
				pair C = B+D;
				
				path a_brace = rotate(20.0)*shift(0,-0.74)*brace(D,A);
				path angle_mark = arc((0,0), point(A--D,0.25), rotate(20.0)*point(A--B, 0.25));
				path angle_mark2 = arc((0,0), point(A--D,0.32), rotate(20.0)*point(A--D, 0.25));
				
				A = rotate(20.0)*A;
				B = rotate(20.0)*B;
				C = rotate(20.0)*C;
				D = rotate(20.0)*D;
				
				draw(A--B--C--D--cycle);
				draw(B--rotate(20.0)*(4,0));
				
				draw(angle_mark);
				draw(angle_mark2);
				label("$h$", rotate(20.0)*(4,2),NE);
				label("$b$", rotate(20.0)*A--B, NW);
				
				draw(a_brace);
				draw(rotate(20.0)*((4,0.6)--(3.4,0.6)--(3.4,0)));
				
				label("$a$", a_brace, rotate(20.0)*S);
				label("$\theta$", angle_mark2, ENE);
				label("$\phi$", angle_mark, ENE);
				
				draw((-2,0)--(10,0),Arrow);
				draw((0,-2)--(0,8),Arrow);
				
				label("$P$", A, SW);
				label("$Q$", B, NW);
				label("$R$", C, NE);
				label("$S$", D, ESE);
			\end{asy}
		\end{minipage}
		\hfill
		\begin{minipage}[b]{0.3\textwidth}
			\centering
			\begin{asy}[width=0.9\textwidth]
				import patterns;
				
				add("brick",brick());
				
				draw((0,0)--(7,0),Arrow);
				draw((0,0)--(0,6),Arrow);
				
				pair A = (0,0);
				pair B = (1,3);
				pair C = (6,5);
				pair D = (5,2);
				
				draw(A--B--C--D--cycle);
				pair K1 = (0,3);
				pair K2=(5,3);
				pair K3 = (5,0);
				pair L0 = (1,2);
				pair L1 = (1,5);
				pair L3 = (6,2);
				
				draw(A--K1--K2--K3--cycle);
				draw(L0--L1--C--L3--cycle);
				
				filldraw(A--K1--B--cycle, pattern("brick"));
				filldraw(A--K3--D--cycle, pattern("brick"));
				filldraw(L0--B--K2--D--cycle, pattern("brick"));
				filldraw(B--L1--C--cycle, pattern("brick"));
				filldraw(D--C--L3--cycle, pattern("brick"));
				
				label("$(a,b)$", B, NW);
				label("$(c,d)$", D, SE);
				label("$(a+c,b+d)$", C, N);
				
				dot(B);
				dot(D);
				dot(C);
			
			\end{asy}
		\end{minipage}
	\end{center}
	\vspace*{-2\baselineskip}
	\begin{center}
		\begin{minipage}[t]{0.3\textwidth}
			\caption{A parallelogram.}
			\label{fig:parallelogram_generic}
		\end{minipage}
		\hfill
		\begin{minipage}[t]{0.3\textwidth}
			\caption{The parallelogram in the $xy$ plane.}
			\label{fig:para_in_xy}
		\end{minipage}
		\hfill
		\begin{minipage}[t]{0.3\textwidth}
			\caption{Scenario for Problem~\ref{prob:unit_square_into_parallelogram}.}
			\label{fig:para_scenario}
		\end{minipage}
	\end{center}
	\vspace*{-2\baselineskip}
\end{figure}

\begin{enumerate}
\setcounter{enumi}{\value{problem_i}}
\item In Figure~\ref{fig:para_in_xy}, we have put our parallelogram onto the $xy$ plane so that the side of length $a$ makes an angle of $\theta$ with the $x$ axis and $b$ makes an angle of $\phi$ with the $x$ axis. Thus, $\varphi=\phi-\theta$.
\begin{enumerate}
\item Rewrite the equation for the area of the parallelogram in terms of $\theta$ and $\phi$.
\item Find the $x$ and $y$ coordinates of $P,Q,R,S$ in terms of $a$, $b$, $\phi$, $\theta$.
\item Write a matrix so that the first column contains the coordinates of $Q$ and the second column contains the coordinates of $S$. This matrix maps the plane.
\item Your matrix has two diagonals. One rises from left to right and the other descends from left to right. Subtract the product of the entries of the ascending diagonal from the product of those of the descending diagonal.
\item Use angle addition formulas to simplify your answer.
\item You should find some relationship between your answers to Problems 11a and 11d. What is it?
\item The difference of the products of the two diagonals of a $2\times 2$ matrix is called the \textbf{determinant} of the matrix, written $\det \left[\begin{array}{cc}a & c \\ b & d \end{array}\right]=ad-bc$. What does it measure?
\item Find a matrix which produces a rotation. What is its determinant?
\item Find a matrix that produces a reflection.
\begin{enumerate}
\item What is the absolute value of its determinant?
\item How does its determinant differ from that of a rotation matrix?
\item What property is not conserved under reflection?
\end{enumerate}
\item Find a matrix which produces a dilation.
\begin{enumerate}
\item What is its determinant?
\item What does the size of its determinant indicate?
\end{enumerate}
\end{enumerate}
\item Here is another way to think about the area of the image of the unit square under a linear transformation. First, we use the matrix $\twomat{a}{c}{b}{d}$ to transform the unit square into a parallelogram. Then, we graph the image. \label{prob:unit_square_into_parallelogram}
\begin{enumerate}
\item There are three rectangles and four triangles in Figure~\ref{fig:para_scenario}. Find the dimensions and the area of each one. You can use this information to figure out the area of the parallelogram in terms of $a$, $b$, $c$, and $d$. Write a sentence or equation explaining how you can use the seven areas to find the area of the parallelogram.
\item Carry out the algebra to find the area.
\item Calculate the determinant of the matrix.
\item What is the relationship between the determinant of the matrix and the area of its associated parallelogram?
\item Consider what happens if $(a,b)$ and $(c,d)$ switch places in the graph.
\begin{enumerate}
\item How would the area you calculated be different?
\item What property would now be preserved by the transformation?
\item What isometry would have been included in any composition of simple transformations yielding the mapping?
\item What would be true of the determinant?
\end{enumerate}
\item \begin{enumerate}
\item What does a reversal of the orientation of figure in its image say about the determinant of the transformation matrix?
\item What does that same property of the determinant imply that a transformational matrix does?
\item What isometry reverses orientation?
\end{enumerate}
\item \begin{enumerate}
\item What would have happened to the parallelogram if we replaced $c,d$ in the matrix with $kc,kd$ for some $k>0$, so that the transformation matrix is $\left[\begin{array}{cc} a & kc \\ b & kd \end{array}\right]$?
\item What would its area be?
\item What would the determinant of the matrix be?
\item What if $\left[\begin{array}{cc}b & d \end{array}\right]=r\left[\begin{array}{cc}a & c \end{array}\right]$? That is, what if the second row of the matrix was a linear multiple of the first row?
\end{enumerate}
\end{enumerate}
\setcounter{problem_i}{\value{enumi}}
\end{enumerate}

\noindent Now that we are aware that the determinant of a matrix is a measure of size change and orientation change, we can decompose any linear mapping into a set of operations that we can visualize. Technically speaking, we can reduce all two dimensional transformational matrices into a combination of reflections and stretches along an axis. It is more intuitive, however, to include rotations, dilations, and shears along an axis in our repertoire of basic operations.

We will look at the image of the unit square under an arbitrary transformation and see how we can undo the transformation in steps until we are left with a unit square. Then we will retrace our steps, undoing each step until we have arrived at our original transformation through a set of mappings, each of which is easily visualized. We are looking for a recipe. Perhaps you can improve on the one that we will outline here! %Start with $$.

\newcounter{first_para}

\begin{enumerate}[label=\roman*.]
\item Start by checking the determinant. If it is nonzero, continue to step (ii). Otherwise, you are done, because the inverse does not exist.\footnote{Why doesn't the inverse exist? Describe the mapping.}
\setcounter{first_para}{\value{enumi}}
\item If $a=0$, rotate the whole matrix $90^\circ$ so that $a$ becomes nonzero.
\item Stretch or shrink your matrix along the $x$ axis so that the top-left entry becomes $1$; this is why we wanted $a$ to be nonzero:

$$\twomat{\frac{1}{a}}{0}{0}{1}\twomat{a}{c}{b}{d} = \twomat{1}{\frac{c}{a}}{b}{d}.$$

\item Shear the vector $\twovec{1}{b}$ to $\twovec{1}{0}$ so that it is parallel to the $x$ axis:

\begin{align*}
\twomat{1}{0}{-b}{1}\twomat{1}{\frac{c}{a}}{b}{d} &= \twomat{1}{\frac{c}{a}}{0}{-\frac{bc}{a}+d} \\
&= \twomat{1}{\frac{c}{a}}{0}{\frac{ad-bc}{a}}.
\end{align*}

\item Stretch in the $y$ direction to make the bottom right entry $1$:

$$\twomat{1}{0}{0}{\frac{a}{ad-bc}}\twomat{1}{\frac{c}{a}}{0}{\frac{ad-bc}{a}}=\twomat{1}{\frac{c}{a}}{0}{1}.$$

\item Shear in the $x$ direction to make the top right entry $0$:

$$\twomat{1}{-\frac{c}{a}}{0}{1}\twomat{1}{\frac{c}{a}}{0}{1}=\twomat{1}{0}{0}{1}.$$
\end{enumerate}

\noindent This process applied to the matrix $\left[\begin{array}{cc}a & c \\ b & d \end{array}\right]=\left[\begin{array}{cc}2 & 3 \\ 4 & 1 \end{array}\right]$, is shown in Figure~\ref{fig:undo_matrix} (some not to scale).

\begin{asydef}
void drawFor(real s_x, real s_y, real a, real c, real b, real d, real ap, real cp, real bp, real dp) {
	a *= s_x;
	c *= s_x;
	ap *= s_x;
	cp *= s_x;
	b *= s_y;
	d *= s_y;
	bp *= s_y;
	dp *= s_y;

	real max_x = 1.2*max(a,c,ap,cp,a+c,ap+cp);
	real min_x = 1.2*min(a,c,ap,cp,a+c,ap+cp,0);
	real max_y = 1.2*max(b,d,bp,dp,b+d,bp+dp,1.5);
	real min_y = 1.2*min(b,d,bp,dp,0,b+d,bp+dp);

	draw((min_x,0)--(max_x,0), Arrow);
	draw((0,min_y)--(0,max_y), Arrow);

	draw((0,0)--(a,b)--(a+c,b+d)--(c,d)--cycle, dashed);
	draw((0,0)--(ap,bp)--(ap+cp,bp+dp)--(cp,dp)--cycle);

	if (s_x != 1 || s_y != 1) {
		//label("Not to scale", (0,max_y), NE);
	}
}
\end{asydef}

\begin{figure}[h]
	\begin{center}
		\begin{minipage}[c]{0.45\textwidth}
			\begin{center}
				\begin{minipage}[b]{0.45\textwidth}
					i.
					\centering
					\begin{asy}[width=0.7\textwidth]
						drawFor(1,1,2,3,4,1,2,3,4,1);
					\end{asy}
				\end{minipage}
				\hfill
				\begin{minipage}[b]{0.45\textwidth}
					iii.
					\centering
					\begin{asy}[width=0.7\textwidth]
						drawFor(1,1,2,3,4,1,1,3/2,4,1);
					\end{asy}
				\end{minipage}
			\end{center}
		
			\begin{center}
				\begin{minipage}[b]{0.45\textwidth}
					iv.
					\centering
					\begin{asy}[width=0.7\textwidth]
						drawFor(3,1,1,3/2,4,1,1,3/2,0,-5);
					\end{asy}
				\end{minipage}
				\hfill
				\begin{minipage}[b]{0.45\textwidth}
					v.
					\centering
					\begin{asy}[width=0.7\textwidth]
						drawFor(3,1,1,3/2,0,-5,1,3/2,0,1);
					\end{asy}
				\end{minipage}
			\end{center}
		
			\begin{center}
				\begin{minipage}[b]{0.45\textwidth}
					vi.
					\centering
					\begin{asy}[width=0.7\textwidth]
						drawFor(1,1,1,3/2,0,1,1,0,0,1);
					\end{asy}
				\end{minipage}
				\hfill
				\begin{minipage}[b]{0.45\textwidth}
					\caption{The undoing steps, visualized.}
					\label{fig:undo_matrix}
				\end{minipage}
			\end{center}
		\end{minipage}
		\hfill
		\begin{minipage}[c]{0.45\textwidth}
			\begin{enumerate}[label=\roman*.]
				\item The determinant is not $0$, so we continue.
				\item $a\neq 0$, so we continue.
				\item $\twomat{\frac{1}{2}}{0}{0}{1}\twomat{2}{3}{4}{1}=\twomat{1}{\frac{3}{2}}{4}{1}.$
				\item $\twomat{1}{0}{-4}{1}\twomat{1}{\frac{3}{2}}{4}{2}=\twomat{1}{\frac{3}{2}}{0}{-5}.$
				\item $\twomat{1}{0}{0}{-\frac{1}{5}}\twomat{1}{\frac{3}{2}}{0}{5}=\twomat{1}{\frac{3}{2}}{0}{1}.$
				\item $\twomat{1}{-\frac{3}{2}}{0}{1}\twomat{1}{\frac{3}{2}}{0}{1}=\twomat{1}{0}{0}{1}.$
			\end{enumerate}
		\end{minipage}
	\end{center}
	\vspace*{-2\baselineskip}
\end{figure}

\begin{enumerate}
\setcounter{enumi}{\value{problem_i}}
\item Look at Figure~\ref{fig:undo_matrix} and describe the transformation in each step.
\setcounter{problem_i}{\value{enumi}}
\end{enumerate}

\noindent To reiterate, our process for undoing a matrix $M=\twomat{a}{c}{b}{d}$ with $a>0$ and $\det M\neq 0$ is:
$$\left[\begin{array}{c}\text{shear} \\ \text{in x}\end{array}\right]
\left[\begin{array}{c}\text{stretch} \\ \text{in y}\end{array}\right]
\left[\begin{array}{c}\text{shear} \\ \text{in y}\end{array}\right]
\left[\begin{array}{c}\text{stretch} \\ \text{in x}\end{array}\right]
\twomat{a}{c}{b}{d}=\twomat{1}{0}{0}{1}.$$
Filling it in with numbers, we get:
$$\twomat{1}{-\frac{c}{a}}{0}{1}\twomat{1}{0}{0}{\frac{a}{ad-bc}}\twomat{1}{0}{-b}{1}\twomat{\frac{1}{a}}{0}{0}{1}\twomat{a}{c}{b}{d}=\twomat{1}{0}{0}{1}.$$ \label{prob:list_of_matrices}

\noindent Don't forget to multiply from right to left.

Our ultimate goal is to build up the matrix from basic operations, not to just undo it. Fortunately, we can easily figure out how to undo each of these basic operations. Remember that matrix multiplication is associative, but not commutative.

\begin{enumerate}
\setcounter{enumi}{\value{problem_i}}
\item \begin{enumerate}
\item How do you undo a shear in the $x$ direction?
$\blanktwomat\twomat{1}{s}{0}{1}=\twomat{1}{0}{0}{1}$
\item How do you undo a stretch along the $x$ axis?
$\blanktwomat\twomat{x}{0}{0}{1}=\twomat{1}{0}{0}{1}$
\item How do you undo a shear in the $y$ direction?
$\blanktwomat\twomat{1}{0}{s}{1}=\twomat{1}{0}{0}{1}$
\item How do you undo a stretch along the $y$ axis?
$\blanktwomat\twomat{1}{0}{0}{y}=\twomat{1}{0}{0}{1}$
\end{enumerate}

\item Now let's put this all together. Undo each of the operations in turn, until only matrix $\left[\begin{array}{cc}a & c \\ b & d \end{array}\right]$ remains on the left side. Remember that what you do on the left side of the expression must also be done to the right side, so on the right side you will see the basic operations from which $\left[\begin{array}{cc}a & c \\ b & d \end{array}\right]$ is composed. Order is important!

\vspace{5em}
$$\mathop{\blanktwomat}^{\tikzmark{a1}}
\mathop{\blanktwomat}^{\tikzmark{b1}}
\mathop{\blanktwomat}^{\tikzmark{c1}}
\mathop{\blanktwomat}^{\tikzmark{d1}}
\mathop{\twomat{1}{-\frac{c}{a}}{0}{1}}^{\tikzmark{d2}}
\mathop{\twomat{1}{0}{0}{\frac{a}{ad-bc}}}^{\tikzmark{c2}}
\mathop{\twomat{1}{0}{-b}{1}}^{\tikzmark{b2}}
\mathop{\twomat{\frac{1}{a}}{0}{0}{1}}^{\tikzmark{a2}}
\twomat{a}{c}{b}{d}$$
$$\Longrightarrow \blanktwomat\blanktwomat\blanktwomat\blanktwomat\twomat{1}{0}{0}{1} = \twomat{a}{c}{b}{d}$$

\tikz[remember picture,auto]{
\path[overlay, ->] (pic cs:a1) edge [bend left] node {undoes} (pic cs:a2);
\path[overlay, ->] (pic cs:b1) edge [bend left] node {undoes} (pic cs:b2);
\path[overlay, ->] (pic cs:c1) edge [bend left] node {undoes} (pic cs:c2);
\path[overlay, ->] (pic cs:d1) edge [bend left] node {undoes} (pic cs:d2);
}
\setcounter{problem_i}{\value{enumi}}
\end{enumerate}

\noindent This process is known as \textbf{matrix decomposition}, because you are decomposing the matrix into simpler pieces. Now, let's see if you can apply this idea to find a set of basic transformations that is equivalent to some sample matrices.

\begin{enumerate}
\setcounter{enumi}{\value{problem_i}}
\item \label{prob:needed_for_matrix_undo1}Each step in the decomposition of $\twomat{3}{4}{2}{-5}$ is explained below.
\begin{enumerate}[label=(\roman*)]
\begin{multicols}{2}
\item Stretch along the $x$ axis by factor of $\frac{1}{3}$. %compare-books-disable
$$\twomat{\frac{1}{3}}{0}{0}{1}\twomat{3}{4}{2}{-5}=\twomat{1}{\frac{4}{3}}{2}{-5}$$
\item Shear perpendicular to the $x$ axis by $-2$. %compare-books-disable
$$\twomat{1}{0}{-2}{1}\twomat{1}{\frac{4}{3}}{2}{-5}=\twomat{1}{\frac{4}{3}}{0}{-\frac{23}{3}}$$
\item Stretch along $y$ axis by $-\frac{3}{23}$. %compare-books-disable
$$\twomat{1}{0}{0}{-\frac{3}{23}}\twomat{1}{\frac{4}{3}}{0}{-\frac{23}{3}}=\twomat{1}{\frac{4}{3}}{0}{1}$$
\item Shear perpendicular to the $y$ axis by $-\frac{4}{3}$. %compare-books-disable
$$\twomat{1}{-\frac{4}{3}}{0}{1}\twomat{1}{\frac{4}{3}}{0}{1}=\twomat{1}{0}{0}{1}$$
\end{multicols}
\end{enumerate}
Taken all together, the decomposition is:
$$\twomat{1}{-\frac{4}{3}}{0}{1}\twomat{1}{0}{0}{-\frac{3}{23}}\twomat{1}{0}{-2}{1}\twomat{\frac{1}{3}}{0}{0}{1}\twomat{3}{4}{2}{-5}.$$
Therefore: $$\twomat{3}{4}{2}{-5}=\twomat{3}{0}{0}{1}\twomat{1}{0}{2}{1}\twomat{1}{0}{0}{-\frac{23}{3}}\twomat{1}{\frac{4}{3}}{0}{1}.$$
What does each matrix do?
\item\label{prob:needed_for_matrix_undo2}Here is another way that you could have decomposed the above matrix:
\vspace{-1em}
$$\mathop{\twomat{1}{0}{0}{\frac{13}{23}}}^{\text{i}}
\mathop{\twomat{1}{-\frac{2}{23}}{0}{1}}^{\text{ii}}
\mathop{\twomat{\frac{1}{\sqrt{13}}}{0}{0}{\frac{1}{\sqrt{13}}}}^{\text{iii}}
\mathop{\twomat{\frac{3}{\sqrt{13}}}{-\frac{2}{\sqrt{13}}}{\frac{2}{\sqrt{13}}}{\frac{3}{\sqrt{13}}}}^{\text{iv}}
\mathop{\twomat{1}{0}{0}{-1}}^{\text{v}}
\twomat{3}{4}{2}{-5}=\twomat{1}{0}{0}{1}.$$
\begin{enumerate}
\item Identify what matrices i through v each do.
\end{enumerate}
Next, we undo this sequence of operations by working backwards:
\vspace{-1em}
$$\mathop{\twomat{1}{0}{0}{-1}}^{\text{i}}
\mathop{\twomat{\frac{3}{\sqrt{13}}}{\frac{2}{\sqrt{13}}}{-\frac{2}{\sqrt{13}}}{\frac{3}{\sqrt{13}}}}^{\text{ii}}
\mathop{\twomat{\sqrt{13}}{0}{0}{\sqrt{13}}}^{\text{iii}}
\mathop{\twomat{1}{\frac{2}{23}}{0}{1}}^{\text{iv}}
\mathop{\twomat{1}{0}{0}{\frac{23}{13}}}^{\text{v}}
\twomat{1}{0}{0}{1}=\twomat{3}{4}{2}{-5}.$$
\begin{enumerate}
\setcounter{enumii}{1}
\item Explain what happens at each matrix, i through v.
\end{enumerate}
\item Find a set of basic transformations which is equivalent to each of the following matrices:\label{prob:basic_transformations}
\begin{enumerate}
\begin{multicols}{3}
\item $\twomat{12}{8}{5}{15}$
\item $\twomat{3}{24}{4}{7}$
\item $\twomat{2}{3}{4}{6}$
\end{multicols}
\end{enumerate}
\item One of the matrices in Problem~\ref{prob:basic_transformations} is a projection onto a line.
\begin{enumerate}
\begin{multicols}{2}
\item Which matrix is it?
\item What line does it project onto?
\item If you try to decompose this matrix to the identity matrix, what happens? Why?
\end{multicols}
\end{enumerate}
\item Onto what line does $\left[\begin{array}{cc} a & b \\ 2a & 2b\end{array}\right]$ map the plane? Solve for $a$ and $b$ such that the matrix projects perpendicular onto the line. You can do this because you know that a point on the line should not move under the projection and a point on a line perpendicular to the line has its image on the origin. Using this information you can set up two equations with two unknowns. \label{prob:project_the_plane}
\item Use Problem~\ref{prob:project_the_plane} to decompose $\twomat{2}{3}{4}{6}$ into a projection to a line followed by a size change.
\item Decompose $\left[\begin{array}{cc} 1 & 2 \\ 3 & 6\end{array}\right]$ into a projection perpendicular to a line followed by a size change.
\item Write matrices which project onto the following lines:
\begin{enumerate}
\begin{multicols}{3}
\item $y=x$
\item $y=5x$
\item $y=mx$
\end{multicols}
\end{enumerate}
\end{enumerate}
\end{document}
